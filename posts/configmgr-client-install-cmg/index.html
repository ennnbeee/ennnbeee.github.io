<!DOCTYPE html>
<html lang="en" dir="ltr" class="scroll-smooth" data-default-appearance="dark"
  data-auto-appearance="true"><head>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>Installing the Configuration Manager Client on Orphaned Internet Devices</title>
  <meta name="title" content="Installing the Configuration Manager Client on Orphaned Internet Devices" />
  
  <meta name="description" content="Using Microsoft Intune to deploy the Configuration Manager (SCCM) client using Win32 Apps to hybrid joined devices on the internet where they have lost communication, to allow connection to a Cloud Management Gateway (CMG)." />
  <meta name="keywords" content="powershell, apps, co-management, " />
  
  <meta name="robots" content="all" />
  
  
  <link rel="canonical" href="https://memv.ennbee.uk/posts/configmgr-client-install-cmg/" />
  
  
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.7bc0f74ad613e540578d3676aafe60e8878b514f95b897830dad1894033e2dc1feed7d6d8941bcfa251051a88b6ca9b17366911bf43a82089ff9050000643c00.css"
    integrity="sha512-e8D3StYT5UBXjTZ2qv5g6IeLUU&#43;VuJeDDa0YlAM&#43;LcH&#43;7X1tiUG8&#43;iUQUaiLbKmxc2aRG/Q6ggif&#43;QUAAGQ8AA==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.94423161281b8fd1ac69e1efd2cdbbd6c0ab06d7e5e3bc444b9784e8c3050834518955d2a9ce0479ece7055f350b513d5facc34cbb9fb4ad4d02c7733ba643c1.js"
    integrity="sha512-lEIxYSgbj9GsaeHv0s271sCrBtfl47xES5eE6MMFCDRRiVXSqc4EeeznBV81C1E9X6zDTLuftK1NAsdzO6ZDwQ=="></script>
  
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.cab249ec2f87c8efdec1594e650838fcb9837dff59bf06c71a79fe5e0a7a0f19fcca05399fe094d181e68eb57354ed0b2328cfe53accab2b24257f0beda841a9.js"
    integrity="sha512-yrJJ7C&#43;HyO/ewVlOZQg4/LmDff9ZvwbHGnn&#43;Xgp6Dxn8ygU5n&#43;CU0YHmjrVzVO0LIyjP5TrMqyskJX8L7ahBqQ==" data-copy="" data-copied=""></script>
  
  
  <script src="/js/zoom.min.js"></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  <meta name="google-site-verification" content="ma5La6cWDE6YXvljJ7w3991FminUAxur2sqavzMSnpU" />
  
  
  
  
  
  <meta property="og:url" content="https://memv.ennbee.uk/posts/configmgr-client-install-cmg/">
  <meta property="og:site_name" content="MEM v ENNBEE - Battles with Modern Endpoint Management">
  <meta property="og:title" content="Installing the Configuration Manager Client on Orphaned Internet Devices">
  <meta property="og:description" content="Using Microsoft Intune to deploy the Configuration Manager (SCCM) client using Win32 Apps to hybrid joined devices on the internet where they have lost communication, to allow connection to a Cloud Management Gateway (CMG).">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-09-02T20:43:33+01:00">
    <meta property="article:modified_time" content="2024-09-02T20:43:33+01:00">
    <meta property="article:tag" content="PowerShell">
    <meta property="article:tag" content="Apps">
    <meta property="article:tag" content="Co-management">
    <meta property="og:image" content="https://memv.ennbee.uk/posts/configmgr-client-install-cmg/featured.png">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://memv.ennbee.uk/posts/configmgr-client-install-cmg/featured.png">
  <meta name="twitter:title" content="Installing the Configuration Manager Client on Orphaned Internet Devices">
  <meta name="twitter:description" content="Using Microsoft Intune to deploy the Configuration Manager (SCCM) client using Win32 Apps to hybrid joined devices on the internet where they have lost communication, to allow connection to a Cloud Management Gateway (CMG).">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Installing the Configuration Manager Client on Orphaned Internet Devices",
    "headline": "Installing the Configuration Manager Client on Orphaned Internet Devices",
    "description": "Using Microsoft Intune to deploy the Configuration Manager (SCCM) client using Win32 Apps to hybrid joined devices on the internet where they have lost communication, to allow connection to a Cloud Management Gateway (CMG).",
    "abstract": "You\u0026rsquo;ve just implemented a Cloud Management Gateway to help your hybrid joined Windows devices communicate to Configuration Manager over the internet, but what if they\u0026rsquo;re orphaned and unable to communicate to Configuration Manager to get the new Client Settings?",
    "inLanguage": "en",
    "url" : "https:\/\/memv.ennbee.uk\/posts\/configmgr-client-install-cmg\/",
    "author" : {
      "@type": "Person",
      "name": "Nick Benton"
    },
    "copyrightYear": "2024",
    "dateCreated": "2024-09-02T20:43:33\u002b01:00",
    "datePublished": "2024-09-02T20:43:33\u002b01:00",
    
    "dateModified": "2024-09-02T20:43:33\u002b01:00",
    
    "keywords": ["powershell","apps","co-management"],
    
    "mainEntityOfPage": "true",
    "wordCount": "3262"
  }]
  </script>


  
  
  <meta name="author" content="Nick Benton" />
  
  
  
  <link href="https://learn.microsoft.com/en-us/users/ennnbeee/credentials" rel="me" />
  
  
  <link href="https://github.com/ennnbeee" rel="me" />
  
  
  <link href="https://www.linkedin.com/in/ennnbeee/" rel="me" />
  
  
  <link href="https://twitter.com/ennnbee" rel="me" />
  
  
  <link href="https://bsky.app/profile/ennnbeee.bsky.social" rel="me" />
  
  
  <link href="https://www.youtube.com/@ennnbeee" rel="me" />
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>






















  
  
  
  
  <meta name="theme-color"/>
  
  
  
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script>

    const firebaseConfig = {
      apiKey: "AIzaSyCdoYM2WvSY3kvcPgdeh-VO-SzEMUZwYjY",
      authDomain: "AIzaSyCdoYM2WvSY3kvcPgdeh-VO-SzEMUZwYjY",
      projectId: "memvennbee",
      storageBucket: "memvennbee.appspot.com",
      messagingSenderId: "395697438623",
      appId: "1:395697438623:web:ce5d7d42dea8e265b947aa",
      measurementId: "G-EM0CM5PL0C"
    };

    var app = firebase.initializeApp(firebaseConfig);
    var db = firebase.firestore();
    var auth = firebase.auth();

  </script>
  
  
</head>

    <script>
      if (localStorage.getItem("doNotTrack") === null) {
        localStorage.setItem("doNotTrack", "1") 
      }
      var doNotTrack = localStorage.getItem("doNotTrack");
    </script>
    <div id="cookie-notice">
    <span>We use necessary cookies to make the site work. We'd like to set additional cookies to understand site usage and make site improvements.</span>
    <a id="cookie-notice-accept" class="btn btn-primary btn-sm">Accept Cookies</a>
    <a id="cookie-notice-deny" class="btn btn-primary btn-sm">Reject Cookies</a>
    <a href="/information/#privacy" class="btn btn-primary btn-sm">Show Cookie Purposes</a></div>
    <script>
        function createCookie(name,value,days) {
            var expires = "";
            if (days) {
                var date = new Date();
                date.setTime(date.getTime() + (days*24*60*60*1000));
                expires = "; expires=" + date.toUTCString();
            }
            document.cookie = name + "=" + value + expires + "; path=/";
        }
        function readCookie(name) {
            var nameEQ = name + "=";
            var ca = document.cookie.split(';');
            for(var i=0;i < ca.length;i++) {
                var c = ca[i];
                while (c.charAt(0)==' ') c = c.substring(1,c.length);
                if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
            }
            return null;
        }
        function eraseCookie(name) {
            createCookie(name,"",-1);
        }

        if(readCookie('cookie-notice-option')=='true') {
            
                    localStorage.setItem("doNotTrack", "0");
            
        } else if (readCookie('cookie-notice-option')!='false'){
            document.getElementById('cookie-notice').style.display = 'block';
        }

        document.getElementById('cookie-notice-accept').addEventListener("click",function() {
            createCookie('cookie-notice-option','true',31);
            document.getElementById('cookie-notice').style.display = 'none';
            location.reload();
        });

        document.getElementById('cookie-notice-deny').addEventListener("click",function() {
            createCookie('cookie-notice-option','false',31);
            document.getElementById('cookie-notice').style.display = 'none';
            location.reload();
        });
    </script>
    

<script async src="https://www.googletagmanager.com/gtag/js?id=G-EM0CM5PL0C"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EM0CM5PL0C');
</script>


<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px]" style="z-index:100">
  <div id="menu-blur" class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom bg-neutral dark:bg-neutral-800"></div>
  <div class="relative max-w-[64rem] ml-auto mr-auto">
    <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    
    
    <div>
        <a href="/" class="flex">
            <span class="sr-only">MEM v ENNBEE - Battles with Modern Endpoint Management</span>

            
            <img src="/img/logo_dk.png" width="250" height="104"
                class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt="MEM v ENNBEE - Battles with Modern Endpoint Management" />
            

        </a>
    </div>
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            

        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            
            
            
  <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Posts
    </p>
</a>



            
             
  <div>
  <div class="cursor-pointer flex items-center nested-menu">
    
    <a  class="text-base font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="">
      Topics
    </a>
    <span>
      

  <span class="relative block icon">
    <svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>

  </span>


    </span>
  </div>
  <div class="absolute menuhide">
    <div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl">
      <div class="flex flex-col space-y-3">
        
        <a href="/categories/intune/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Microsoft Intune
          </p>
        </a>
        
        <a href="/categories/windows/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Windows
          </p>
        </a>
        
        <a href="/categories/macos/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            macOS
          </p>
        </a>
        
        <a href="/categories/android/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Android
          </p>
        </a>
        
        <a href="/categories/ios/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            iOS/iPadOS
          </p>
        </a>
        
        <a href="/categories/configmgr/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Configuration Manager
          </p>
        </a>
        
      </div>
    </div>
  </div>
</div>



            
            
  <a href="https://github.com/ennnbeee/mve-scripts/"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <span >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


    </span>
    
    <p class="text-base font-medium" title="">
        
    </p>
</a>



            
            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400" style="margin-right:5px">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" class="block">
            
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:5px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">

                    <li id="menu-close-button">
                        <span
                            class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    

                    
  <li class="mt-1">
    <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Posts
        </p>
    </a>
</li>




                    

                     
  <li class="mt-1">
    <a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Topics
        </p>
        <span>
            

  <span class="relative block icon">
    <svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>

  </span>


        </span>
    </a>
</li>

<li class="mt-1">
    <a href="/categories/intune/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Microsoft Intune
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/categories/windows/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Windows
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/categories/macos/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            macOS
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/categories/android/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Android
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/categories/ios/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            iOS/iPadOS
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/categories/configmgr/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Configuration Manager
        </p>
    </a>
</li>

<li class="mb-2"></li>




                    

                    
  <li class="mt-1">
    <a href="https://github.com/ennnbeee/mve-scripts/"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <div >
            

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


        </div>
        
        <p class="text-bg font-bg" title="">
            
        </p>
    </a>
</li>




                    

                </ul>
                
                

            </div>
        </label>
    </div>
</div>




<script>
    (function () {
        var $mainmenu = $('.main-menu');
        var path = window.location.pathname;
        $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
            $(e).children('p').addClass('active');
        });
    })();
</script>


  </div>
</div>
<script>
  window.addEventListener('scroll', function (e) {
    var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
    var background_blur = document.getElementById('menu-blur');
    background_blur.style.opacity = (scroll / 300);
  });
</script>

  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  
  
  
  
  
  




    
    <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"
    style="background-image:url(/posts/configmgr-client-install-cmg/featured.png);">
    


    <div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal">
    </div>
    <div
        class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal">
    </div>
</div>

<div id="background-blur" class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div>
<script>
    window.addEventListener('scroll', function (e) {
        var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
        var background_blur = document.getElementById('background-blur');
        background_blur.style.opacity = (scroll / 300)
    });
</script>

  
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      Installing the Configuration Manager Client on Orphaned Internet Devices
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  









  









  



<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-09-02T20:43:33&#43;01:00">2 September 2024</time><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="views_posts/ConfigMgr-Client-Install-CMG/index.md" class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title="views">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
  </span>

</span>
</span><span class="px-2 text-primary-500">&middot;</span>


<script type="text/javascript" src="/js/zen-mode.min.63c8a202661f4a2063fdc2706685d668e8ea3da613da2224e9da527e5876e4f53dcac39ab60732626fb4151feae5d430d0cf44731e5d3c726522fcc1519c1547.js" integrity="sha512-Y8iiAmYfSiBj/cJwZoXWaOjqPaYT2iIk6dpSflh25PU9ysOatgcyYm&#43;0FR/q5dQw0M9Ecx5dPHJlIvzBUZwVRw=="></script>

<span class="mb-[2px]">
    <span id="zen-mode-button"
          class="text-lg hover:text-primary-500"
          title="Enable zen mode"
          data-title-i18n-disable="Enable zen mode"
          data-title-i18n-enable="Disable zen mode">
        <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="50px" height="50px">
    <path fill="currentColor" d="M 12.980469 4 C 9.1204688 4 5.9804688 7.14 5.9804688 11 L 6 26 L 9.9804688 26 L 9.9804688 11 C 9.9804688 9.35 11.320469 8 12.980469 8 L 40.019531 8 C 41.679531 8 43.019531 9.35 43.019531 11 L 43.019531 39 C 43.019531 40.65 41.679531 42 40.019531 42 L 29 42 C 29 43.54 28.420938 44.94 27.460938 46 L 40.019531 46 C 43.879531 46 47.019531 42.86 47.019531 39 L 47.019531 11 C 47.019531 7.14 43.879531 4 40.019531 4 L 12.980469 4 z M 7 28 C 4.794 28 3 29.794 3 32 L 3 42 C 3 44.206 4.794 46 7 46 L 23 46 C 25.206 46 27 44.206 27 42 L 27 32 C 27 29.794 25.206 28 23 28 L 7 28 z M 7 32 L 23 32 L 23.001953 42 L 7 42 L 7 32 z"/>
</svg>
  </span>

</span>
    </span>
</span>
  

  
  
</div>





<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/intune/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Microsoft Intune
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/configmgr/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Microsoft Configuration Manager
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/windows/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Windows 10 and later
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/powershell/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    PowerShell
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/apps/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Apps
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/co-management/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Co-management
  </span>
</span>
  </span>
  
  
  
  
</div>




    </div>

    
    
    
    
    

    

    
      
      

      
        
            
              
            
          
            
          
          
<div class="flex author author-extra mt-4">
  
      
      
        
          
        
        <img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width="96" height="96"
          src="/img/ennbee_hu4969719971627417776.png" />
      
  
  <div class="place-self-center">
    
    
    <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
      Author
    </div>
    <a  href="https://memv.ennbee.uk/authors/ennbee/"  class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
      Nick Benton
    </a>
    
    
    <div class="text-sm text-neutral-700 dark:text-neutral-400">Principal Cloud Endpoint Consultant | Intune Blogger</div>
    
    <div class="text-2xl sm:text-lg">
      <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
        
        
        <a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="https://github.com/ennnbeee" target="_blank"
          aria-label="Github" rel="me noopener noreferrer"><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</span></a>
        
        
        
        <a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="https://www.linkedin.com/in/ennnbeee/" target="_blank"
          aria-label="Linkedin" rel="me noopener noreferrer"><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>

</span></a>
        
        
        
        <a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="https://learn.microsoft.com/en-us/users/ennnbeee/credentials" target="_blank"
          aria-label="Microsoft" rel="me noopener noreferrer"><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span></a>
        
        
        
        <a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="https://twitter.com/ennnbee" target="_blank"
          aria-label="Twitter" rel="me noopener noreferrer"><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>

  </span>

</span></a>
        
        
        
        <a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="https://www.youtube.com/@ennnbeee" target="_blank"
          aria-label="Youtube" rel="me noopener noreferrer"><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>

  </span>

</span></a>
        
        
        
        <a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="https://www.credly.com/users/ennnbeee" target="_blank"
          aria-label="Graduation-Cap" rel="me noopener noreferrer"><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
<path fill="currentColor" d="M320 32c-8.1 0-16.1 1.4-23.7 4.1L15.8 137.4C6.3 140.9 0 149.9 0 160s6.3 19.1 15.8 22.6l57.9 20.9C57.3 229.3 48 259.8 48 291.9v28.1c0 28.4-10.8 57.7-22.3 80.8c-6.5 13-13.9 25.8-22.5 37.6C0 442.7-.9 448.3 .9 453.4s6 8.9 11.2 10.2l64 16c4.2 1.1 8.7 .3 12.4-2s6.3-6.1 7.1-10.4c8.6-42.8 4.3-81.2-2.1-108.7C90.3 344.3 86 329.8 80 316.5V291.9c0-30.2 10.2-58.7 27.9-81.5c12.9-15.5 29.6-28 49.2-35.7l157-61.7c8.2-3.2 17.5 .8 20.7 9s-.8 17.5-9 20.7l-157 61.7c-12.4 4.9-23.3 12.4-32.2 21.6l159.6 57.6c7.6 2.7 15.6 4.1 23.7 4.1s16.1-1.4 23.7-4.1L624.2 182.6c9.5-3.4 15.8-12.5 15.8-22.6s-6.3-19.1-15.8-22.6L343.7 36.1C336.1 33.4 328.1 32 320 32zM128 408c0 35.3 86 72 192 72s192-36.7 192-72L496.7 262.6 354.5 314c-11.1 4-22.8 6-34.5 6s-23.5-2-34.5-6L143.3 262.6 128 408z"/></svg>
  </span>

</span></a>
        
        
      </div>
    </div>
  </div>
</div>


      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
     <div
      class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]">

         <details open id="TOCView"
  class="toc-right mt-0 overflow-y-scroll overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#client-communication">Client Communication</a>
      <ul>
        <li><a href="#just-install-the-client">Just Install the Client</a></li>
      </ul>
    </li>
    <li><a href="#client-authentication">Client Authentication</a>
      <ul>
        <li><a href="#pki-authentication">PKI Authentication</a></li>
        <li><a href="#entra-authentication">Entra Authentication</a></li>
      </ul>
    </li>
    <li><a href="#client-installation-settings">Client Installation Settings</a>
      <ul>
        <li><a href="#command-line-installation">Command Line Installation</a></li>
        <li><a href="#installation-script">Installation Script</a></li>
      </ul>
    </li>
    <li><a href="#application-packaging">Application Packaging</a>
      <ul>
        <li><a href="#using-the-intunewinapputil">Using the IntuneWinAppUtil</a></li>
      </ul>
    </li>
    <li><a href="#client-deployment">Client Deployment</a>
      <ul>
        <li><a href="#pki-authentication-application">PKI Authentication Application</a></li>
        <li><a href="#entra-authentication-application">Entra Authentication Application</a></li>
      </ul>
    </li>
    <li><a href="#client-installation">Client Installation</a>
      <ul>
        <li><a href="#microsoft-intune-reporting">Microsoft Intune Reporting</a></li>
        <li><a href="#client-installation-logs">Client Installation Logs</a></li>
      </ul>
    </li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#client-communication">Client Communication</a>
      <ul>
        <li><a href="#just-install-the-client">Just Install the Client</a></li>
      </ul>
    </li>
    <li><a href="#client-authentication">Client Authentication</a>
      <ul>
        <li><a href="#pki-authentication">PKI Authentication</a></li>
        <li><a href="#entra-authentication">Entra Authentication</a></li>
      </ul>
    </li>
    <li><a href="#client-installation-settings">Client Installation Settings</a>
      <ul>
        <li><a href="#command-line-installation">Command Line Installation</a></li>
        <li><a href="#installation-script">Installation Script</a></li>
      </ul>
    </li>
    <li><a href="#application-packaging">Application Packaging</a>
      <ul>
        <li><a href="#using-the-intunewinapputil">Using the IntuneWinAppUtil</a></li>
      </ul>
    </li>
    <li><a href="#client-deployment">Client Deployment</a>
      <ul>
        <li><a href="#pki-authentication-application">PKI Authentication Application</a></li>
        <li><a href="#entra-authentication-application">Entra Authentication Application</a></li>
      </ul>
    </li>
    <li><a href="#client-installation">Client Installation</a>
      <ul>
        <li><a href="#microsoft-intune-reporting">Microsoft Intune Reporting</a></li>
        <li><a href="#client-installation-logs">Client Installation Logs</a></li>
      </ul>
    </li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>
  </div>
</details>

<script>

  var margin = 200;
  var marginError = 50;

  (function () {
    var $window = $(window);
    var $toc = $('#TOCView');
    var tocHeight = $toc.height();

    function onResize() {
      var windowAndMarginHeight = $window.height() - margin;
      if(tocHeight >= windowAndMarginHeight) {
        $toc.css("overflow-y", "scroll")
        $toc.css("max-height", (windowAndMarginHeight + marginError) + "px")
      } else {
        $toc.css("overflow-y", "hidden")
        $toc.css("max-height", "9999999px")
      }
    }

    $window.on('resize', onResize);
    $(document).ready(onResize);
  })();



  (function () {
    var $toc = $('#TableOfContents');
    if ($toc.length > 0) {
      var $window = $(window);

      function onScroll() {
        var currentScroll = $window.scrollTop();
        var h = $('.anchor');
        var id = "";
        h.each(function (i, e) {
          e = $(e);
          if (e.offset().top - $(window).height()/3 <= currentScroll) {
            id = decodeURIComponent(e.attr('id'));
          }
        });
        var active = $toc.find('a.active');      
        if (active.length == 1 && active.eq(0).attr('href') == '#' + id) return true;

        active.each(function (i, e) {
           
            $(e).removeClass('active').siblings('ul').hide();
          
        });
        $toc.find('a[href="#' + id + '"]').addClass('active')
        $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
          $(e).children('a').parents('ul').show();          
        });
      }

      $window.on('scroll', onScroll);
      $(document).ready(function () {
         
          $toc.find('a').parent('li').find('ul').hide();
        
        onScroll();
      });
    }
  })();


</script>
   </div>
      </div>
      

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          <p>You&rsquo;ve just implemented a Cloud Management Gateway to help your hybrid joined Windows devices communicate to Configuration Manager over the internet, but what if they&rsquo;re orphaned and unable to communicate to Configuration Manager to get the new Client Settings?</p>
<p>This one might be little niche if I&rsquo;m honest, but there <em>is</em> a scenario where you&rsquo;ve implemented a <a href="https://learn.microsoft.com/en-us/mem/configmgr/core/clients/manage/cmg/overview" target="_blank">Cloud Management Gateway</a> (CMG) as part of your Configuration Manager topology, your hybrid joined Windows devices are <a href="https://learn.microsoft.com/en-us/mem/configmgr/comanage/overview" target="_blank">co-managed</a>, but they no longer communicate back to the on-premises Configuration Manager Management Point for some reason, and you need to tell these remote devices that they can now use the Cloud Management Gateway.</p>
<p>The reason could be that you have a user initiated VPN that no-one actually uses, you&rsquo;re lacking a device tunnel for communication back to on-premises services, or you just have no VPN whatsoever, and these devices have just aged out of Configuration Manager never to be seen again.</p>
<p>How on earth are we going to sort these rogue orphaned devices out, and get them back speaking with Configuration Manager and a Cloud Management Gateway?</p>


<h2 class="relative group">Client Communication 
    <div id="client-communication" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#client-communication" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Usually after implementing a Cloud Management Gateway, you just wait for your devices to check back in to the Management Point during a location request, and when they&rsquo;re classified as <strong>Currently Internet</strong> they&rsquo;ll happily communicate with the CMG, as long as they meet the <a href="https://learn.microsoft.com/en-us/mem/configmgr/core/clients/manage/cmg/configure-authentication" target="_blank">client authentication</a> requirements obviously.</p>
<p>This won&rsquo;t work for devices that don&rsquo;t currently talk to Configuration Manager, nor if they&rsquo;ve disappeared from the console and discovery. So how do we deal with this?</p>


<h3 class="relative group">Just Install the Client 
    <div id="just-install-the-client" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#just-install-the-client" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Strangely, Microsoft actually recommended just re-installing the ConfigMgr Client on these devices, which isn&rsquo;t a bad shout, so that&rsquo;s at least the start of the process; with the devices hybrid joined and co-managed for at least the <a href="https://learn.microsoft.com/en-us/mem/configmgr/comanage/workloads#client-apps" target="_blank">Client Apps</a> workload, we can just package up the latest ConfigMgr client from the Primary Site server and punt it to the device estate.</p>
<p><em>&ldquo;Oh, but what about using native tooling, isn&rsquo;t there a way to get Microsoft Intune to do this for you?&rdquo;</em>, I hear you cry. Well <a href="https://techcommunity.microsoft.com/t5/microsoft-intune-blog/co-management-settings-windows-autopilot-with-co-management/ba-p/3638500" target="_blank">yes</a>, but also <a href="https://learn.microsoft.com/en-us/mem/configmgr/comanage/autopilot-enrollment#limitations" target="_blank">no</a>.</p>
<blockquote>
<p>Microsoft Entra hybrid joined devices - If the device is targeted with co-management settings policy, in Microsoft Entra hybrid join scenario, the autopilot provisioning times out during ESP phase.</p>
</blockquote>
<p>and&hellip;</p>
<blockquote>
<p>Clients that authenticate with PKI certificates. You can&rsquo;t provision the certificate on the device before the Configuration Manager client installs and needs to authenticate to the CMG. Microsoft Entra ID is recommended for client authentication. For more information, see Plan for CMG client authentication: Microsoft Entra ID.</p>
</blockquote>
<p>The co-management authority setting in Microsoft Intune is great, for your <strong>Entra only</strong> Autopilot devices, and as covered <a href="/posts/configmgr-client-hybrid-autopilot" rel="noopener" target="_blank">previously</a>, but just doesn&rsquo;t work for the hybrid joined world, so a Win32 app it is, but what else do we need to consider?</p>


<h2 class="relative group">Client Authentication 
    <div id="client-authentication" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#client-authentication" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Before we even look at packaging up the Configuration Manager client, we need to think about how these now essentially Internet-based devices are going to authenticate and communicate to the Cloud Management Gateway.</p>
<p>As these aren&rsquo;t fresh out the box devices, we shouldn&rsquo;t need to treat them as such, so we can discard the need of using a <a href="https://learn.microsoft.com/en-us/mem/configmgr/core/clients/deploy/deploy-clients-cmg-token" target="_blank">site token</a> as part of the installation, as these devices will already be hybrid joined, or have a device certificate to allow existing authentication.</p>
<p>With this we can just look at how we make sure the devices are meeting the client authentication pre-requisites for the following two client authentication methods.</p>


<h3 class="relative group">PKI Authentication 
    <div id="pki-authentication" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#pki-authentication" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>I&rsquo;m going to take a stab in the dark and suggest that these orphaned devices, if using PKI authentication, already have a certificate and the full chain of trust required to allow for <a href="https://learn.microsoft.com/en-us/mem/configmgr/core/clients/manage/cmg/configure-authentication#pki-certificate" target="_blank">PKI authentication</a>, but we should be sure of this and not just assume.</p>
<p>So as part of our soon to be packaged Win32 app, we need to utilise a PowerShell script to check that a certificate from your Internal Certification Authority exists with the correct extensions, and it&rsquo;s valid using <a href="https://learn.microsoft.com/en-us/mem/intune/apps/apps-win32-add#step-3-requirements" target="_blank">App Requirements</a> in Microsoft Intune.</p>
<p>Throwing together a quick script and updating the <code>$certCA</code> with the distinguished name of your Issuing Certification Authority, we can loop through all certificates issued to the device, making sure that the certificate has come from your internal CA, then check if the date is valid.</p>







  
  

  
    
  
  
  

  
  
  
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="nv">$ready</span> <span class="p">=</span> <span class="mf">0</span>
</span></span><span class="line"><span class="cl"><span class="nv">$certCA</span> <span class="p">=</span> <span class="s1">&#39;CN=ennbee-LAB-CA, DC=ennbee, DC=local&#39;</span> <span class="c">#Certificate Authority Name</span>
</span></span><span class="line"><span class="cl"><span class="nv">$date</span> <span class="p">=</span> <span class="nb">Get-Date</span> <span class="c">#Used for checking valid certificate</span>
</span></span><span class="line"><span class="cl"><span class="nv">$certPath</span> <span class="p">=</span> <span class="s1">&#39;cert:\LocalMachine\My&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$certs</span> <span class="p">=</span> <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="nv">$certPath</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$cert</span> <span class="k">in</span> <span class="nv">$certs</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$certThumbPath</span> <span class="p">=</span> <span class="nv">$certPath</span> <span class="p">+</span> <span class="s2">&#34;\</span><span class="p">$(</span><span class="nv">$cert</span><span class="p">.</span><span class="n">Thumbprint</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$cert</span><span class="p">.</span><span class="py">Issuer</span> <span class="o">-eq</span> <span class="nv">$certCA</span> <span class="o">-and</span> <span class="nv">$cert</span><span class="p">.</span><span class="py">Extensions</span><span class="p">.</span><span class="py">EnhancedKeyUsages</span><span class="p">.</span><span class="py">FriendlyName</span> <span class="o">-contains</span> <span class="s1">&#39;Client Authentication&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$certValid</span> <span class="p">=</span> <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="nv">$certThumbPath</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">NotAfter</span><span class="p">,</span> <span class="n">NotBefore</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$date</span> <span class="o">-gt</span> <span class="nv">$certValid</span><span class="p">.</span><span class="py">NotBefore</span> <span class="o">-and</span> <span class="nv">$date</span> <span class="o">-lt</span> <span class="nv">$certValid</span><span class="p">.</span><span class="n">NotAfter</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nv">$ready</span><span class="p">++</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$ready</span> <span class="o">-gt</span> <span class="mf">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Output</span> <span class="n">Ready</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>


<p>If the script finds at least one certificate, as really the Configuration Manager client isn&rsquo;t that fussy about which certificate it uses, just that there is one, the script will return a <code>Ready</code> output back to Microsoft Intune, which we can then use as a positive identifier that the app installation can start.</p>


<h3 class="relative group">Entra Authentication 
    <div id="entra-authentication" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#entra-authentication" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>If you decided that you couldn&rsquo;t be bothered with PKI authentication (I mean who can really?), then the other option would have been to leverage the <a href="https://learn.microsoft.com/en-us/mem/configmgr/core/clients/manage/cmg/configure-authentication#microsoft-entra-id" target="_blank">Microsoft Entra ID</a> join state of the device, and here we&rsquo;re making more broad assumptions that you&rsquo;re meeting all other <a href="https://learn.microsoft.com/en-us/mem/configmgr/core/clients/deploy/deploy-clients-cmg-azure" target="_blank">pre-requisites</a> for this authentication method.</p>
<p>The one we care about is the join state, as really this is the only one we can query from the client itself, so more PowerShell and using the ever trusty <a href="https://learn.microsoft.com/en-us/entra/identity/devices/troubleshoot-device-dsregcmd" target="_blank">dsregcmd</a> to get the join state of the device.</p>







  
  

  
    
  
  
  

  
  
  
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="nv">$ready</span> <span class="p">=</span> <span class="mf">0</span>
</span></span><span class="line"><span class="cl"><span class="nv">$dsRegCmd</span> <span class="p">=</span> <span class="n">dsregcmd</span> <span class="p">/</span><span class="n">status</span>
</span></span><span class="line"><span class="cl"><span class="nv">$dsRegOutput</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">-TypeName</span> <span class="n">PSObject</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$dsRegCmd</span> <span class="p">|</span> <span class="nb">Select-String</span> <span class="n">-Pattern</span> <span class="s1">&#39; *[A-z]+ : [A-z]+ *&#39;</span> <span class="p">|</span> <span class="nb">ForEach-Object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Add-Member</span> <span class="n">-InputObject</span> <span class="nv">$dsRegOutput</span> <span class="n">-MemberType</span> <span class="n">NoteProperty</span> <span class="n">-Name</span> <span class="p">(([</span><span class="no">String</span><span class="p">]</span><span class="nv">$_</span><span class="p">).</span><span class="py">Trim</span><span class="p">()</span> <span class="n">-split</span> <span class="s1">&#39; : &#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">]</span> <span class="n">-Value</span> <span class="p">(([</span><span class="no">String</span><span class="p">]</span><span class="nv">$_</span><span class="p">).</span><span class="py">Trim</span><span class="p">()</span> <span class="n">-split</span> <span class="s1">&#39; : &#39;</span><span class="p">)[</span><span class="mf">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$dsRegOutput</span><span class="p">.</span><span class="py">AzureAdJoined</span> <span class="o">-eq</span> <span class="s1">&#39;YES&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$ready</span><span class="p">++</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$ready</span> <span class="o">-gt</span> <span class="mf">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Output</span> <span class="n">Ready</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>


<p>With a bit of a hack, we can take the output of <code>dsregcmd /status</code> and throw it into a new <code>PSObject</code>, which gives us an sample output of the below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="n">AzureAdJoined</span>             <span class="err">:</span> <span class="n">YES</span>
</span></span><span class="line"><span class="cl"><span class="n">EnterpriseJoined</span>          <span class="err">:</span> <span class="n">NO</span>
</span></span><span class="line"><span class="cl"><span class="n">DomainJoined</span>              <span class="err">:</span> <span class="n">YES</span>
</span></span><span class="line"><span class="cl"><span class="n">Virtual</span> <span class="n">Desktop</span>           <span class="err">:</span> <span class="n">NOT</span> <span class="nb">SET
</span></span></span><span class="line"><span class="cl"><span class="nb"></span><span class="n">Device</span> <span class="n">Name</span>               <span class="err">:</span> <span class="n">XXXXXX</span>
</span></span><span class="line"><span class="cl"><span class="n">Thumbprint</span>                <span class="err">:</span> <span class="n">XXXXXX</span>
</span></span><span class="line"><span class="cl"><span class="n">DeviceCertificateValidity</span> <span class="err">:</span> <span class="p">[</span> <span class="mf">2023</span><span class="p">-</span><span class="mf">10</span><span class="p">-</span><span class="mf">31</span> <span class="mf">13</span><span class="err">:</span><span class="mf">36</span><span class="err">:</span><span class="mf">52.000</span> <span class="n">UTC</span> <span class="p">--</span> <span class="mf">2033</span><span class="p">-</span><span class="mf">10</span><span class="p">-</span><span class="mf">31</span> <span class="mf">14</span><span class="err">:</span><span class="mf">06</span><span class="err">:</span><span class="mf">52.000</span> <span class="n">UTC</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">KeyProvider</span>               <span class="err">:</span> <span class="n">Microsoft</span> <span class="n">Platform</span> <span class="n">Crypto</span> <span class="n">Provider</span>
</span></span><span class="line"><span class="cl"><span class="n">TpmProtected</span>              <span class="err">:</span> <span class="n">YES</span>
</span></span><span class="line"><span class="cl"><span class="n">DeviceAuthStatus</span>          <span class="err">:</span> <span class="n">SUCCESS</span>
</span></span><span class="line"><span class="cl"><span class="n">TenantName</span>                <span class="err">:</span> <span class="n">MEM</span> <span class="n">v</span> <span class="n">ENNBEE</span>
</span></span></code></pre></div><p>With the area we care about being the <code>AzureAdJoined</code> state, which can be referenced with <code>$dsRegOutput.AzureAdJoined</code> in the PowerShell script. Sticking with the <code>Ready</code> output here as well, we now have something we can confirm as part of the requirements for the application installation.</p>


<h2 class="relative group">Client Installation Settings 
    <div id="client-installation-settings" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#client-installation-settings" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>As we&rsquo;re using Microsoft Intune to push out a packaged version of the client, we can&rsquo;t rely on a standard <a href="https://learn.microsoft.com/en-us/mem/intune/apps/apps-win32-add#step-4-detection-rules" target="_blank">detection rule</a> such as file , msi, or registry, as there is no guarantee that the version of the client already installed, isn&rsquo;t the same as the one we&rsquo;re trying to deploy.</p>
<p>To get around this little hurdle, along with a couple of others along the way including the installation parameter for the ConfigMgr client, we need to create a PowerShell script to carry out the installation for us, taking into consideration the two main authentications methods of PKI and Entra authentication, as well as the requirements for the <a href="https://learn.microsoft.com/en-us/mem/configmgr/core/clients/deploy/about-client-installation-properties" target="_blank">command line installation</a>.</p>


<h3 class="relative group">Command Line Installation 
    <div id="command-line-installation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#command-line-installation" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>For both authentication types, we need the following command line options and switches:</p>
<ul>
<li><code>CCMHOSTNAME</code> - The You&rsquo;ll find the Cloud Management Gateway hostname in the ConfigMgr console under the Cloud Services settings.</li>
<li><code>SMSSITECODE</code> - Is pretty obviously your ConfigMgr site code.</li>
<li><code>SMSMP</code> - Required to specify the internal management point when the client is set to intranet connectivity.</li>
<li><code>/mp</code> - The management point address for the Cloud Management Gateway, it&rsquo;s the one with the &lsquo;https://&rsquo; prefix.</li>
<li><code>/forceinstall</code> will uninstall the existing client first, and is useful if the installed version of the client is the same as the version being deployed.</li>
</ul>
<p>With the PKI authentication we need some additional switches:</p>
<ul>
<li><code>/NoCRLCheck</code> - Useful if the internal PKI environment hasn&rsquo;t a public certificate revocation list (CRL), no needed if you&rsquo;re using a public certificate on the Cloud Management Gateway.</li>
<li><code>/UsePKICert</code> - Tells the installation to use a PKI certificate for authentication to the Cloud Management Gateway.</li>
</ul>
<p>Finally for Entra authentication we need some details from the Enterprise App used for this authentication method when setting up <a href="https://learn.microsoft.com/en-us/mem/configmgr/core/servers/deploy/configure/azure-services-wizard" target="_blank">Azure Services</a> in ConfigMgr:</p>
<ul>
<li><code>AADTENANTID</code> - Can be found in your Entra ID tenant.</li>
<li><code>AADCLIENTAPPID</code> - Is the Client ID of the Enterprise App and can be found in Entra ID.</li>
<li><code>AADRESOURCEURI</code> - Is the internal URL used for the service sometimes it&rsquo;s in the format &lsquo;https://localhost&rsquo; can be found in Enterprise App in Entra ID.</li>
</ul>
<p>So with all these switches now available, time to put them to good use and create a PowerShell script, that can be used for both authentication methods.</p>


<h3 class="relative group">Installation Script 
    <div id="installation-script" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#installation-script" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>As I don&rsquo;t like to repeat myself, we can create one PowerShell script for both authentication types, using a switch parameter to control which of the command line settings are used for the installation, and passing though the details of the below mandatory parameters for both installation types:</p>
<ul>
<li><code>ccmSiteCode</code> - ConfigMgr Site Code, so something like <code>&quot;ENB&quot;</code>.</li>
<li><code>ccmMP</code> - The URL of the internal ConfigMgr Management Point such as <code>&quot;https://configmgrmp.ennbee.local&quot;</code>.</li>
<li><code>cmgAddress</code> - The address of the Cloud Management Gateway (without the &lsquo;https://&rsquo; bit, as we&rsquo;re building that for the required parameter), so <code>&quot;CONFIGMGRCMG.CLOUDAPP.NET/CCM_Proxy_MutualAuth/72186325152220500&quot;</code></li>
</ul>
<p>For the parameters required for the PKI authentication:</p>
<ul>
<li><code>PKI</code> - A switch parameter that used to create the command line arguments for PKI authentication over Entra authentication.</li>
</ul>
<p>For the Entra authentication method we need to pass through the non-mandatory parameters:</p>
<ul>
<li><code>tenantId</code> - This is the UUID for your tenant, so something similar to <code>&quot;daf4a1c2-3a0c-401b-966f-0b855d3abd1a&quot;</code></li>
<li><code>clientAppId</code> - The client App object ID from Entra, so for me it&rsquo;s <code>&quot;7506ee10-f7ec-415a-b415-cd3d58790d97&quot;</code></li>
<li><code>clientAppURL</code> - The client App URI configured in the Enterprise App, like <code>&quot;https://localhost&quot;</code></li>
</ul>
<p>I&rsquo;ve left these as non-mandatory and without any flight checks, as you&rsquo;re not going to, a) see the output of the script, and b) I trust you to just use the script correctly.</p>
<p>So we now have an installation script in all its glory, ready to be packaged along with the ConfigMgr client installation files so we can punt it into Microsoft Intune.</p>







  
  

  
    
  
  
  

  
  
  
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="p">[</span><span class="nb">CmdletBinding</span><span class="p">()]</span>
</span></span><span class="line"><span class="cl"><span class="k">param</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">Mandatory</span> <span class="p">=</span> <span class="vm">$false</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">switch</span><span class="p">]</span><span class="nv">$PKI</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">Mandatory</span> <span class="p">=</span> <span class="vm">$true</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">String</span><span class="p">]</span><span class="nv">$ccmSiteCode</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">Mandatory</span> <span class="p">=</span> <span class="vm">$true</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">String</span><span class="p">]</span><span class="nv">$ccmMP</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">Mandatory</span> <span class="p">=</span> <span class="vm">$true</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">String</span><span class="p">]</span><span class="nv">$cmgAddress</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">Mandatory</span> <span class="p">=</span> <span class="vm">$false</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">String</span><span class="p">]</span><span class="nv">$tenantId</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">Mandatory</span> <span class="p">=</span> <span class="vm">$false</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">String</span><span class="p">]</span><span class="nv">$clientAppId</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nb">Parameter</span><span class="p">(</span><span class="na">Mandatory</span> <span class="p">=</span> <span class="vm">$false</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="no">String</span><span class="p">]</span><span class="nv">$clientAppURL</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$PKI</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$arguments</span> <span class="p">=</span> <span class="s2">&#34;/forceinstall /NoCRLCheck /UsePKICert /mp:</span><span class="p">$(</span><span class="s1">&#39;https://&#39;</span> <span class="p">+</span> <span class="nv">$cmgAddress</span><span class="p">)</span><span class="s2"> CCMHOSTNAME=</span><span class="p">$(</span><span class="nv">$cmgAddress</span><span class="p">)</span><span class="s2"> SMSSITECODE=</span><span class="p">$(</span><span class="nv">$ccmSiteCode</span><span class="p">)</span><span class="s2"> SMSMP=</span><span class="p">$(</span><span class="nv">$ccmMP</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$arguments</span> <span class="p">=</span> <span class="s2">&#34;/forceinstall /mp:</span><span class="p">$(</span><span class="s1">&#39;https://&#39;</span> <span class="p">+</span> <span class="nv">$cmgAddress</span><span class="p">)</span><span class="s2"> CCMHOSTNAME=</span><span class="p">$(</span><span class="nv">$cmgAddress</span><span class="p">)</span><span class="s2"> SMSSITECODE=</span><span class="p">$(</span><span class="nv">$ccmSiteCode</span><span class="p">)</span><span class="s2"> SMSMP=</span><span class="p">$(</span><span class="nv">$ccmMP</span><span class="p">)</span><span class="s2"> AADTENANTID=</span><span class="p">$(</span><span class="nv">$tenantId</span><span class="p">)</span><span class="s2"> AADCLIENTAPPID=</span><span class="p">$(</span><span class="nv">$clientAppId</span><span class="p">)</span><span class="s2"> AADRESOURCEURI=</span><span class="p">$(</span><span class="nv">$clientAppURL</span><span class="p">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">Start-Process</span> <span class="n">-FilePath</span> <span class="s2">&#34;</span><span class="nv">$PSScriptRoot</span><span class="s2">\ccmsetup.exe&#34;</span> <span class="n">-PassThru</span> <span class="n">-Wait</span> <span class="n">-ArgumentList</span> <span class="nv">$arguments</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Create a tag file just so Intune knows this was run</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$tagPath</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="p">$(</span><span class="nv">$env:ProgramData</span><span class="p">)</span><span class="s2">\Microsoft\CCMCMGInstall&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">If</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="nv">$tagPath</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">mkdir</span> <span class="nv">$tagPath</span> <span class="n">-Force</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$scriptName</span> <span class="p">=</span> <span class="nv">$MyInvocation</span><span class="p">.</span><span class="py">MyCommand</span><span class="p">.</span><span class="py">Name</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Set-Content</span> <span class="n">-Path</span> <span class="s2">&#34;</span><span class="nv">$tagPath</span><span class="s2">\</span><span class="nv">$scriptName</span><span class="s2">.tag&#34;</span> <span class="n">-Value</span> <span class="s2">&#34;Installed&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">catch</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$error</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>



  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >To allow us to detect whether the installation of the app has happened, and to avoid using native detection methods, I&rsquo;ve included the creation of a <strong>.tag</strong> file in the script, which we can look for as part of the detection.</span>
</div>

<p>To give you an example of the what the commands look like for PKI authentication it should look something like the below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="p">.\</span><span class="nb">Install-ConfigMgrClientCMG</span><span class="p">.</span><span class="py">ps1</span> <span class="n">-PKI</span> <span class="n">-ccmSiteCode</span> <span class="s2">&#34;ENB&#34;</span> <span class="n">-ccmMP</span> <span class="s2">&#34;https://configmgrmp.ennbee.local&#34;</span> <span class="n">-cmgAddress</span> <span class="s2">&#34;CONFIGMGRCMG.CLOUDAPP.NET/CCM_Proxy_MutualAuth/72186325152220500&#34;</span>
</span></span></code></pre></div><p>And for Entra authentication it&rsquo;ll look like this, making sure to pass through the additional parameters for <code>$tenantId</code>, <code>$clientAppId</code> , and <code>$clientAppURL</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="p">.\</span><span class="nb">Install-ConfigMgrClientCMG</span><span class="p">.</span><span class="py">ps1</span> <span class="n">-ccmSiteCode</span> <span class="s2">&#34;ENB&#34;</span> <span class="n">-ccmMP</span> <span class="s2">&#34;https://configmgrmp.ennbee.local&#34;</span> <span class="n">-cmgAddress</span> <span class="s2">&#34;CONFIGMGRCMG.CLOUDAPP.NET/CCM_Proxy_MutualAuth/72186325152220500&#34;</span> <span class="n">-tenantId</span> <span class="s2">&#34;daf4a1c2-3a0c-401b-966f-0b855d3abd1a&#34;</span> <span class="n">-clientAppId</span> <span class="s2">&#34;7506ee10-f7ec-415a-b415-cd3d58790d97&#34;</span> <span class="n">-clientAppURL</span> <span class="s2">&#34;https://localhost&#34;</span>
</span></span></code></pre></div><p>Script done, time to package it up and punt it out to clients.</p>


<h2 class="relative group">Application Packaging 
    <div id="application-packaging" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#application-packaging" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Packaging up the Configuration Manager client for deployment from Microsoft Intune has been documented countless times, so just do a quick <del>Bing</del> Google <a href="https://letmegooglethat.com/?q=SCCM&#43;Client&#43;Intune" target="_blank">search</a>, but I&rsquo;ll cover the high level steps so you don&rsquo;t have to flit about the internet:</p>
<ol>
<li>Grab a copy of the latest client installation files from your Configuration Manager Primary Site server and plonk them somewhere on your Windows device:
<ul>
<li>They&rsquo;ll be in <code>\\localhost\SMS_[SITECODE]\cd.latest\SMSSETUP\CLIENT</code> where <code>[SITECODE]</code> is your site code.</li>
</ul>
</li>
<li>Go and get the latest version of the <a href="https://github.com/microsoft/Microsoft-Win32-Content-Prep-Tool" target="_blank">Microsoft-Win32-Content-Prep-Tool</a>
<ul>
<li>Extract this somewhere sensible on your computer.</li>
</ul>
</li>
<li>Download the Client installation script from my <a href="https://github.com/ennnbeee/mve-scripts/blob/main/Intune/Apps/ConfigMgrCMG/Install-ConfigMgrClientCMG.ps1" target="_blank">GitHub repo</a>.
<ul>
<li>Place this in the same location as the Configuration Manager client files, where <code>ccmsetup.exe</code> exists in fact.</li>
</ul>
</li>
</ol>
<p>You should now have a folder with the client install content and PowerShell script looking like this:</p>
<p>



      <figure>
        <img class="my-0 rounded-md" loading="lazy" src="https://memv.ennbee.uk/posts/configmgr-client-install-cmg/img/cmg-folder_hu2209175228332537900.png#left" alt="Configuration Manager Client folder" />
        <figcaption>Configuration Manager client installation files.</figcaption>
      </figure></p>
<p>Time to package the files.</p>


<h3 class="relative group">Using the IntuneWinAppUtil 
    <div id="using-the-intunewinapputil" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#using-the-intunewinapputil" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Now we have all the required files, navigate in an elevated Terminal window to where you extracted the Microsoft-Win32-Content-Prep-Tool, running a command similar to the below, specifying the source folder (<code>-c</code>) as where you copied the Configuration Manager client installation files, the setup file (<code>-s</code>)  as the PowerShell script, and the output (<code>-o</code>)  where you want the new intunewin file to be created:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="p">.\</span><span class="n">IntuneWinAppUtil</span><span class="p">.</span><span class="py">exe</span> <span class="n">-c</span> <span class="s2">&#34;C:\Source\Installers\CCMClient&#34;</span> <span class="n">-s</span> <span class="nb">Install-ConfigMgrClientCMG</span><span class="p">.</span><span class="py">ps1</span> <span class="n">-o</span> <span class="s2">&#34;C:\Source\Installers&#34;</span> <span class="n">-q</span>
</span></span></code></pre></div><p>This will hopefully give us an output similar to the below:</p>
<p>



      <figure>
        <img class="my-0 rounded-md" loading="lazy" src="https://memv.ennbee.uk/posts/configmgr-client-install-cmg/img/cmg-package_hu656046284529120503.png#left" alt="Microsoft-Win32-Content-Prep-Tool Output" />
        <figcaption>Output of the Microsoft-Win32-Content-Prep-Tool command.</figcaption>
      </figure></p>
<p>And a new file <strong>Install-ConfigMgrClientCMG.intunewin</strong> in <strong>C:\Source\Installers</strong> ready to be uploaded to Microsoft Intune.</p>


<h2 class="relative group">Client Deployment 
    <div id="client-deployment" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#client-deployment" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>The rest of the deployment process happens over in Microsoft Intune so throw yourself over to Windows Apps blade, as we&rsquo;ll need to create two new Win32 apps for each of our authentication methods, uploading the same <strong>.intunewin</strong> file for both apps.</p>
<p>Both applications will have similar App Information, so feel free to amend the wording in this section.</p>
<p>



      <figure>
        <img class="my-0 rounded-md" loading="lazy" src="https://memv.ennbee.uk/posts/configmgr-client-install-cmg/img/cmg-appinfo_hu15183893065812224569.png#left" alt="Microsoft Intune Win32App" />
        <figcaption>App Info section in Microsoft Intune for the Win32app.</figcaption>
      </figure></p>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >I haven&rsquo;t bothered configuring an app logo, as Microsoft don&rsquo;t 👀.</span>
</div>



<h3 class="relative group">PKI Authentication Application 
    <div id="pki-authentication-application" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#pki-authentication-application" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>When configuring the PKI authentication application, our installation command and requirements need to reflect this authentication type, so for our install command we need something like the below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="s2">&#34;%systemroot%\sysnative\WindowsPowerShell\v1.0\powershell.exe&#34;</span> <span class="n">-NoProfile</span> <span class="n">-ExecutionPolicy</span> <span class="n">Bypass</span> <span class="o">-File</span> <span class="nb">Install-ConfigMgrClientCMG</span><span class="p">.</span><span class="py">ps1</span> <span class="n">-PKI</span> <span class="n">-ccmSiteCode</span> <span class="s2">&#34;ENB&#34;</span> <span class="n">-ccmMP</span> <span class="s2">&#34;https://configmgrmp.ennbee.local&#34;</span> <span class="n">-cmgAddress</span> <span class="s2">&#34;CONFIGMGRCMG.CLOUDAPP.NET/CCM_Proxy_MutualAuth/72186325152220500&#34;</span>
</span></span></code></pre></div><p>The uninstall command is just removing the <strong>.tag</strong> file we create during the installation script:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="cl">cmd.exe /c del <span class="nv">%ProgramData%</span>\Microsoft\CCMCMGInstall\Install-ConfigMgrClientCMG.ps1.tag
</span></span></code></pre></div><p>



      <figure>
        <img class="my-0 rounded-md" loading="lazy" src="https://memv.ennbee.uk/posts/configmgr-client-install-cmg/img/cmg-program_hu12954437774450160278.png#left" alt="Microsoft Intune Win32App" />
        <figcaption>Program section in Microsoft Intune for the Win32app for PKI authentication.</figcaption>
      </figure></p>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >Make sure you update the installation time and the installation context otherwise you&rsquo;ll be in for a bad time.</span>
</div>

<p>As we&rsquo;ve taken the time to write a custom requirement rule, we need to add this to the standard requirements section, uploading the <a href="https://github.com/ennnbeee/mve-scripts/blob/main/Intune/Apps/ConfigMgrCMG/Requirement-ConfigMgrClientPKI.ps1" target="_blank">script</a> for PKI authentication we created and modified previously, and updating the output data type to <code>String</code> and expected value of <code>Ready</code> accordingly.</p>
<p>



      <figure>
        <img class="my-0 rounded-md" loading="lazy" src="https://memv.ennbee.uk/posts/configmgr-client-install-cmg/img/cmg-pkireqs_hu11799747003780748598.png#left" alt="Microsoft Intune Win32App" />
        <figcaption>Requirements section in Microsoft Intune for the Win32app for PKI authentication.</figcaption>
      </figure></p>
<p>Moving on to the next page in the process, we need to create our Detection rule using the <strong>.tag</strong> file that gets created during the installation. So go and add a new detection rule using the File option, with the path to the file being <strong>%ProgramData%\Microsoft\CCMCMGInstall</strong> and checking if the <strong>Install-ConfigMgrClientCMG.ps1.tag</strong> file exists:</p>
<p>



      <figure>
        <img class="my-0 rounded-md" loading="lazy" src="https://memv.ennbee.uk/posts/configmgr-client-install-cmg/img/cmg-appdetect_hu17629975824624602717.png#left" alt="Microsoft Intune Win32App" />
        <figcaption>Detection Rule section in Microsoft Intune for the Win32app for PKI authentication.</figcaption>
      </figure></p>
<p>We can skip to the end of the process, as we have no further settings to configure, and I&rsquo;d suggest assigning this on a small Proof-of-Concept group as part of testing, prior to just launching it to your entire device estate.</p>
<p>PKI authentication done, what about the Entra authentication?</p>


<h3 class="relative group">Entra Authentication Application 
    <div id="entra-authentication-application" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#entra-authentication-application" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>This process is going to look very familiar, but there some key differences, but the start is the same so go create a new Windows app (Win32) in Microsoft Intune, complete the App information page with the information needed after uploading the <strong>.intunewin</strong> file again.</p>
<p>For the Program page, we need to amend our install command to the below passing in the required parameters we covered earlier:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="s2">&#34;%systemroot%\sysnative\WindowsPowerShell\v1.0\powershell.exe&#34;</span> <span class="n">-NoProfile</span> <span class="n">-ExecutionPolicy</span> <span class="n">Bypass</span> <span class="o">-File</span> <span class="nb">Install-ConfigMgrClientCMG</span><span class="p">.</span><span class="py">ps1</span> <span class="n">-ccmSiteCode</span> <span class="s2">&#34;ENB&#34;</span> <span class="n">-ccmMP</span> <span class="s2">&#34;https://configmgrmp.ennbee.local&#34;</span> <span class="n">-cmgAddress</span> <span class="s2">&#34;CONFIGMGRCMG.CLOUDAPP.NET/CCM_Proxy_MutualAuth/72186325152220500&#34;</span> <span class="n">-tenantId</span> <span class="s2">&#34;daf4a1c2-3a0c-401b-966f-0b855d3abd1a&#34;</span> <span class="n">-clientAppId</span> <span class="s2">&#34;7506ee10-f7ec-415a-b415-cd3d58790d97&#34;</span> <span class="n">-clientAppURL</span> <span class="s2">&#34;https://localhost&#34;</span>
</span></span></code></pre></div><p>The uninstall command remains the same however:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="cl">cmd.exe /c del <span class="nv">%ProgramData%</span>\Microsoft\CCMCMGInstall\Install-ConfigMgrClientCMG.ps1.tag
</span></span></code></pre></div><p>



      <figure>
        <img class="my-0 rounded-md" loading="lazy" src="https://memv.ennbee.uk/posts/configmgr-client-install-cmg/img/cmg-program_hu12954437774450160278.png#left" alt="Microsoft Intune Win32App" />
        <figcaption>Program section in Microsoft Intune for the Win32app for Entra authentication.</figcaption>
      </figure></p>
<p>As with the PKI authentication configuration we need to add our Entra requirement <a href="https://github.com/ennnbeee/mve-scripts/blob/main/Intune/Apps/ConfigMgrCMG/Requirement-ConfigMgrClientEntra.ps1" target="_blank">script</a>, updating the output data type to <code>String</code> and value of <code>Ready</code>.</p>
<p>



      <figure>
        <img class="my-0 rounded-md" loading="lazy" src="https://memv.ennbee.uk/posts/configmgr-client-install-cmg/img/cmg-entrareqs_hu3687296696028158997.png#left" alt="Microsoft Intune Win32App" />
        <figcaption>Requirements section in Microsoft Intune for the Win32app for Entra authentication.</figcaption>
      </figure></p>
<p>Same as with PKI authentication we need to create our Detection rule using the very same <code>.tag</code> file.</p>
<p>



      <figure>
        <img class="my-0 rounded-md" loading="lazy" src="https://memv.ennbee.uk/posts/configmgr-client-install-cmg/img/cmg-appdetect_hu17629975824624602717.png#left" alt="Microsoft Intune Win32App" />
        <figcaption>Detection Rule section in Microsoft Intune for the Win32app for Entra authentication.</figcaption>
      </figure></p>
<p>Click Click Next OK-ing our way to the end, we now have both applications ready to be deployed to our orphaned Configuration Manager client devices.</p>


<h2 class="relative group">Client Installation 
    <div id="client-installation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#client-installation" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>If you really want to double-down on getting this issue resolved, you can deploy both apps with the differing installation commands and requirements to the same Entra ID group, then regardless of whether they&rsquo;ve got a valid certificate or they&rsquo;re Entra joined, they&rsquo;ll give the Configuration Manager client installation a good go.</p>
<p>As the detection method is the same for both apps, you&rsquo;re not going to impact devices that have already run one or the other app.</p>


<h3 class="relative group">Microsoft Intune Reporting 
    <div id="microsoft-intune-reporting" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#microsoft-intune-reporting" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Giving Microsoft Intune a little while to catch up with the deployments, we should start seeing devices report back their installation status, and show any devices that are not meeting the requirements:</p>
<p>



      <figure>
        <img class="my-0 rounded-md" loading="lazy" src="https://memv.ennbee.uk/posts/configmgr-client-install-cmg/img/cmg-reqsfail_hu7799812460221954909.png#left" alt="Configuration Manager PKI Client App" />
        <figcaption>A device failing the PKI requirements check in Microsoft Intune.</figcaption>
      </figure></p>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >With the same assignment group being used across both apps, we need to keep an eye out for devices that are failing <em>both</em> requirements checks.</span>
</div>

<p>As well as devices that are actually reporting as installing the application:</p>
<p>



      <figure>
        <img class="my-0 rounded-md" loading="lazy" src="https://memv.ennbee.uk/posts/configmgr-client-install-cmg/img/cmg-win_hu13051094983508365866.png#left" alt="Configuration Manager PKI Client App Overview" />
        <figcaption>App installation overview in Microsoft Intune.</figcaption>
      </figure></p>
<p>This isn&rsquo;t the end of the story though, as Microsoft Intune is just telling us whether the client setup files are now on the targeted devices after meeting either the Entra Join or Client Certificate requirements.</p>


<h3 class="relative group">Client Installation Logs 
    <div id="client-installation-logs" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#client-installation-logs" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Now we&rsquo;ve assigned our new app to a group of devices that are no longer communicating with Configuration Manager, we can go and jump on a device targeted by the app, and keep an eye on the <a href="https://learn.microsoft.com/en-us/mem/configmgr/core/plan-design/hierarchy/log-files#BKMK_ClientInstallLog" target="_blank">ccmsetup.log</a> in <strong>C:\Windows\ccmsetup</strong>.</p>
<p>What we&rsquo;re looking for here, is the start of the installation passing through the parameters we configured in the PowerShell script we created:</p>
<p>



      <figure>
        <img class="my-0 rounded-md" loading="lazy" src="https://memv.ennbee.uk/posts/configmgr-client-install-cmg/img/cmg-setuplog_hu1966181293988183575.png#left" alt="Configuration Manager Sup Intune Win32App" />
        <figcaption>The ccmsetup.log log file running the Configuration Manager client installation.</figcaption>
      </figure></p>
<p>You can now trail this log to make sure that the device is authenticating to the Cloud Management Gateway, and await for a final exit code of either <strong>0</strong>, successful install or <strong>7</strong>, pending restart, with both denote that the client has successfully installed, and communicated to Configuration Manager.</p>


<h2 class="relative group">Summary 
    <div id="summary" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#summary" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>This one might not have been the most conventional approach to Configuration Manager client installation, but the situation, as strange as it is, forced our hand to think of a non-standard way to push out the Configuration Manager client to these orphaned Windows devices to allow them to successfully phone home to the Configuration Manager Management Points using the Cloud Management Gateway without physically getting our hands on them.</p>
<p>At least with this method, and not just blindly pushing out the client without the requirements and installation arguments, means that devices are only going to start chatting to the Cloud Management Gateway when they can actually authenticate to it, regardless of which authentication method you&rsquo;re using in your environment.</p>
<p>The status of your clients can be monitored in Configuration Manager <a href="https://learn.microsoft.com/en-us/mem/configmgr/core/clients/manage/cmg/monitor-clients-cloud-management-gateway#cloud-management-dashboard" target="_blank">Cloud management dashboard</a>, as the app we pushed will start the ccmsetup process, authenticate to the Cloud Management Gateway, allowing them to check back in with Configuration Manager.</p>

          
          
          
        </div>
        
        

        
        
  
  <section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://memv.ennbee.uk/posts/configmgr-client-install-cmg/&amp;title=Installing%20the%20Configuration%20Manager%20Client%20on%20Orphaned%20Internet%20Devices"
      title="Share on LinkedIn"
      aria-label="Share on LinkedIn"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://twitter.com/intent/tweet/?url=https://memv.ennbee.uk/posts/configmgr-client-install-cmg/&amp;text=Installing%20the%20Configuration%20Manager%20Client%20on%20Orphaned%20Internet%20Devices"
      title="Tweet on Twitter"
      aria-label="Tweet on Twitter"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://bsky.app/intent/compose?text=Installing%20the%20Configuration%20Manager%20Client%20on%20Orphaned%20Internet%20Devices&#43;https://memv.ennbee.uk/posts/configmgr-client-install-cmg/"
      title="Post on Bluesky"
      aria-label="Post on Bluesky"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256,232.562c-21.183,-41.196 -78.868,-117.97 -132.503,-155.834c-51.378,-36.272 -70.978,-29.987 -83.828,-24.181c-14.872,6.72 -17.577,29.554 -17.577,42.988c0,13.433 7.365,110.138 12.169,126.281c15.873,53.336 72.376,71.358 124.413,65.574c2.66,-0.395 5.357,-0.759 8.089,-1.097c-2.68,0.429 -5.379,0.796 -8.089,1.097c-76.259,11.294 -143.984,39.085 -55.158,137.972c97.708,101.165 133.908,-21.692 152.484,-83.983c18.576,62.291 39.972,180.718 150.734,83.983c83.174,-83.983 22.851,-126.674 -53.408,-137.969c-2.71,-0.302 -5.409,-0.667 -8.089,-1.096c2.732,0.337 5.429,0.702 8.089,1.096c52.037,5.785 108.54,-12.239 124.413,-65.574c4.804,-16.142 12.169,-112.847 12.169,-126.281c-0,-13.434 -2.705,-36.267 -17.577,-42.988c-12.85,-5.806 -32.45,-12.09 -83.829,24.181c-53.634,37.864 -111.319,114.635 -132.502,155.831Z"/></svg>
  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://reddit.com/submit/?url=https://memv.ennbee.uk/posts/configmgr-client-install-cmg/&amp;resubmit=true&amp;title=Installing%20the%20Configuration%20Manager%20Client%20on%20Orphaned%20Internet%20Devices"
      title="Submit to Reddit"
      aria-label="Submit to Reddit"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://api.whatsapp.com/send?text=https://memv.ennbee.uk/posts/configmgr-client-install-cmg/&amp;resubmit=true&amp;title=Installing%20the%20Configuration%20Manager%20Client%20on%20Orphaned%20Internet%20Devices"
      title="Share via WhatsApp"
      aria-label="Share via WhatsApp"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://t.me/share/url?url=https://memv.ennbee.uk/posts/configmgr-client-install-cmg/&amp;resubmit=true&amp;title=Installing%20the%20Configuration%20Manager%20Client%20on%20Orphaned%20Internet%20Devices"
      title="Share via Telegram"
      aria-label="Share via Telegram"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M248,8C111.033,8,0,119.033,0,256S111.033,504,248,504,496,392.967,496,256,384.967,8,248,8ZM362.952,176.66c-3.732,39.215-19.881,134.378-28.1,178.3-3.476,18.584-10.322,24.816-16.948,25.425-14.4,1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25,5.342-39.5,3.652-3.793,67.107-61.51,68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608,69.142-14.845,10.194-26.894,9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7,18.45-13.7,108.446-47.248,144.628-62.3c68.872-28.647,83.183-33.623,92.511-33.789,2.052-.034,6.639.474,9.61,2.885a10.452,10.452,0,0,1,3.53,6.716A43.765,43.765,0,0,1,362.952,176.66Z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://pinterest.com/pin/create/bookmarklet/?url=https://memv.ennbee.uk/posts/configmgr-client-install-cmg/&amp;description=Installing%20the%20Configuration%20Manager%20Client%20on%20Orphaned%20Internet%20Devices"
      title="Pin on Pinterest"
      aria-label="Pin on Pinterest"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M496 256c0 137-111 248-248 248-25.6 0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8 0 128.7-68.8 128.7-154.3 0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1 0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6 0-54.7 41.4-107.6 112-107.6 60.9 0 103.6 41.5 103.6 100.9 0 67.1-33.9 113.6-78 113.6-24.3 0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6 0-19-10.2-34.9-31.4-34.9-24.9 0-44.9 25.7-44.9 60.2 0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9 0 361.1 0 256 0 119 111 8 248 8s248 111 248 248z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://www.facebook.com/sharer/sharer.php?u=https://memv.ennbee.uk/posts/configmgr-client-install-cmg/&amp;quote=Installing%20the%20Configuration%20Manager%20Client%20on%20Orphaned%20Internet%20Devices"
      title="Share on Facebook"
      aria-label="Share on Facebook"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="mailto:?body=https://memv.ennbee.uk/posts/configmgr-client-install-cmg/&amp;subject=Installing%20the%20Configuration%20Manager%20Client%20on%20Orphaned%20Internet%20Devices"
      title="Send via email"
      aria-label="Send via email"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>


    </a>
      
    
  </section>


        


<h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2>
<section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3">
  
  

  <a href="/posts/updating-windows-store-apps/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/posts/updating-windows-store-apps/featured.png);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/posts/updating-windows-store-apps/">Keeping Windows Store Apps Updated with Microsoft Intune</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  









  











<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-02-06T21:03:00&#43;00:00">6 February 2024</time><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="views_posts/Updating-Windows-Store-Apps/index.md" class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title="views">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
  </span>

</span>
</span>
  

  
  
</div>





<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/intune/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Microsoft Intune
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/windows/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Windows 10 and later
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/updates/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Software Updates
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/remediation/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Remediation Scripts
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/apps/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Apps
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/powershell/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    PowerShell
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/windows-autopilot/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Windows Autopilot
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/security/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Security
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>
  
  

  <a href="/posts/windows-cis-patching-gaps-part4/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/posts/windows-cis-patching-gaps-part4/featured.png);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/posts/windows-cis-patching-gaps-part4/">Patching Gaps in the CIS Windows 11 Benchmark - Level 2 Windows 11</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  









  











<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-08-12T21:26:37&#43;01:00">12 August 2024</time><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="views_posts/Windows-CIS-Patching-Gaps-Part4/index.md" class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title="views">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
  </span>

</span>
</span>
  

  
  
</div>





<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/intune/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Microsoft Intune
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/windows/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Windows 10 and later
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/security/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Security
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/cis/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Center for Internet Security (CIS)
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/custom-profiles/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Custom Profiles
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/settings-catalog/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Settings Catalog
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/remediation/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Remediation Scripts
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/powershell/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    PowerShell
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>
  
  

  <a href="/posts/windows-cis-patching-gaps-part3/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/posts/windows-cis-patching-gaps-part3/featured.png);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/posts/windows-cis-patching-gaps-part3/">Patching Gaps in the CIS Windows 11 Benchmark - Level 1 Windows 11</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  









  











<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-07-15T11:26:37&#43;01:00">15 July 2024</time><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="views_posts/Windows-CIS-Patching-Gaps-Part3/index.md" class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title="views">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
  </span>

</span>
</span>
  

  
  
</div>





<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/intune/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Microsoft Intune
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/windows/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Windows 10 and later
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/security/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Security
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/cis/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Center for Internet Security (CIS)
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/endpoint-security/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Endpoint Security
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/remediation/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Remediation Scripts
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/powershell/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    PowerShell
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/settings-catalog/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Settings Catalog
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/custom-profiles/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Custom Profiles
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>
  
</section>

  
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\/ConfigMgr-Client-Install-CMG\/index.md"
        var oid_likes = "likes_posts\/ConfigMgr-Client-Install-CMG\/index.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
      
      
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/posts/updates-self-service-deployment/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Self-Service Software Update Deployments</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-09-24T11:11:47&#43;01:00">24 September 2024</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/posts/windows-cis-patching-gaps-part4/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Patching Gaps in the CIS Windows 11 Benchmark - Level 2 Windows 11</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-08-12T21:26:37&#43;01:00">12 August 2024</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
    
    <div class="pt-3">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="pt-3">
        <script src="https://giscus.app/client.js"
    data-repo="ennnbeee/ennnbeee.github.io"
    data-repo-id="R_kgDOLUU7Lg"
    data-category="Comments"
    data-category-id="DIC_kwDOLUU7Ls4CdUYI"
    data-mapping="title"
    data-strict="0"
    data-reactions-enabled="0"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="https://memv.ennbee.uk/css/giscus.css"
    data-lang="en"
    data-loading=" lazy"
    crossorigin="anonymous"
    async>
  </script>
  <noscript>Please enable JavaScript to view the comments powered by giscus.</noscript>
      </div>
    </div>
    
    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
    <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
      <ul class="flex flex-col list-none sm:flex-row">
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/tags/"
            title="">
            
            Tags
          </a>
        </li>
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/categories/"
            title="">
            
            Categories
          </a>
        </li>
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/information/"
            title="">
            
            Information
          </a>
        </li>
        
      </ul>
    </nav>
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      © 2024 Nick Benton, MEM v ENNBEE
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="https://memv.ennbee.uk/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
