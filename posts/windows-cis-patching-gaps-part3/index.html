<!DOCTYPE html>
<html lang="en" dir="ltr" class="scroll-smooth" data-default-appearance="dark"
  data-auto-appearance="true"><head>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>Patching Gaps in the CIS Windows 11 Benchmark - Level 1 Windows 11</title>
  <meta name="title" content="Patching Gaps in the CIS Windows 11 Benchmark - Level 1 Windows 11" />
  
  <meta name="description" content="Updating the Center for Internet Security (CIS) benchmark build kit for Windows 11 in Microsoft Intune for level 1 security settings." />
  <meta name="keywords" content="security, cis, endpoint security, remediation, powershell, settings catalog, custom profiles, " />
  
  <meta name="robots" content="all" />
  
  
  <link rel="canonical" href="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/" />
  
  
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.f86f937d29d1ddb2537e25814a1ffc0b10780a2013643c69a186c009f9654050cce36ef1fd4f02cadb1184a421d6c1e68256c55f3a86a74719683c087682e98a.css"
    integrity="sha512-&#43;G&#43;TfSnR3bJTfiWBSh/8CxB4CiATZDxpoYbACfllQFDM427x/U8CytsRhKQh1sHmglbFXzqGp0cZaDwIdoLpig==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.94423161281b8fd1ac69e1efd2cdbbd6c0ab06d7e5e3bc444b9784e8c3050834518955d2a9ce0479ece7055f350b513d5facc34cbb9fb4ad4d02c7733ba643c1.js"
    integrity="sha512-lEIxYSgbj9GsaeHv0s271sCrBtfl47xES5eE6MMFCDRRiVXSqc4EeeznBV81C1E9X6zDTLuftK1NAsdzO6ZDwQ=="></script>
  
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.c0cef16810371b941395136ccb2eafe40a48addc95809feade6ac669e5cb276c86ffb755cf434a980188e8005aae6536e268b5906003d9fbf92313dd1eb9597e.js"
    integrity="sha512-wM7xaBA3G5QTlRNsyy6v5ApIrdyVgJ/q3mrGaeXLJ2yG/7dVz0NKmAGI6ABarmU24mi1kGAD2fv5IxPdHrlZfg==" data-copy="" data-copied=""></script>
  
  
  <script src="/js/zoom.min.js"></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  <meta name="google-site-verification" content="ma5La6cWDE6YXvljJ7w3991FminUAxur2sqavzMSnpU" />
  
  
  
  
  
  <meta property="og:url" content="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/">
  <meta property="og:site_name" content="MEM v ENNBEE - Battles with Modern Endpoint Management">
  <meta property="og:title" content="Patching Gaps in the CIS Windows 11 Benchmark - Level 1 Windows 11">
  <meta property="og:description" content="Updating the Center for Internet Security (CIS) benchmark build kit for Windows 11 in Microsoft Intune for level 1 security settings.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-15T11:26:37+01:00">
    <meta property="article:modified_time" content="2024-07-15T11:26:37+01:00">
    <meta property="article:tag" content="Security">
    <meta property="article:tag" content="Center for Internet Security (CIS)">
    <meta property="article:tag" content="Endpoint Security">
    <meta property="article:tag" content="Remediation Scripts">
    <meta property="article:tag" content="PowerShell">
    <meta property="article:tag" content="Settings Catalog">
    <meta property="og:image" content="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/featured.png">
      <meta property="og:see_also" content="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part4/">
      <meta property="og:see_also" content="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part2/">
      <meta property="og:see_also" content="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part1/">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/featured.png">
  <meta name="twitter:title" content="Patching Gaps in the CIS Windows 11 Benchmark - Level 1 Windows 11">
  <meta name="twitter:description" content="Updating the Center for Internet Security (CIS) benchmark build kit for Windows 11 in Microsoft Intune for level 1 security settings.">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Patching Gaps in the CIS Windows 11 Benchmark - Level 1 Windows 11",
    "headline": "Patching Gaps in the CIS Windows 11 Benchmark - Level 1 Windows 11",
    "description": "Updating the Center for Internet Security (CIS) benchmark build kit for Windows 11 in Microsoft Intune for level 1 security settings.",
    "abstract": "The impact of the CIS settings on BitLocker and Windows Autopilot now done and dusted, we should broaden our horizons and start to look at what other problems the CIS level 1 benchmark brings to Windows 11 as a whole. Are there any? Will it be smooth sailing? Yeah, no.",
    "inLanguage": "en",
    "url" : "https:\/\/memv.ennbee.uk\/posts\/windows-cis-patching-gaps-part3\/",
    "author" : {
      "@type": "Person",
      "name": "Nick Benton"
    },
    "copyrightYear": "2024",
    "dateCreated": "2024-07-15T11:26:37\u002b01:00",
    "datePublished": "2024-07-15T11:26:37\u002b01:00",
    
    "dateModified": "2024-07-15T11:26:37\u002b01:00",
    
    "keywords": ["security","cis","endpoint security","remediation","powershell","settings catalog","custom profiles"],
    
    "mainEntityOfPage": "true",
    "wordCount": "4331"
  }]
  </script>


  
  
  <meta name="author" content="Nick Benton" />
  
  
  
  <link href="https://learn.microsoft.com/en-us/users/ennnbeee/credentials" rel="me" />
  
  
  <link href="https://github.com/ennnbeee" rel="me" />
  
  
  <link href="https://www.linkedin.com/in/ennnbeee/" rel="me" />
  
  
  <link href="https://twitter.com/ennnbee" rel="me" />
  
  
  <link href="https://www.youtube.com/@ennnbeee" rel="me" />
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>






















  
  
  
  
  <meta name="theme-color"/>
  
  
  
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script>

    const firebaseConfig = {
      apiKey: "AIzaSyCdoYM2WvSY3kvcPgdeh-VO-SzEMUZwYjY",
      authDomain: "AIzaSyCdoYM2WvSY3kvcPgdeh-VO-SzEMUZwYjY",
      projectId: "memvennbee",
      storageBucket: "memvennbee.appspot.com",
      messagingSenderId: "395697438623",
      appId: "1:395697438623:web:ce5d7d42dea8e265b947aa",
      measurementId: "G-EM0CM5PL0C"
    };

    var app = firebase.initializeApp(firebaseConfig);
    var db = firebase.firestore();
    var auth = firebase.auth();

  </script>
  
  
</head>

    <script>
      if (localStorage.getItem("doNotTrack") === null) {
        localStorage.setItem("doNotTrack", "1") 
      }
      var doNotTrack = localStorage.getItem("doNotTrack");
    </script>
    <div id="cookie-notice">
    <span>We use necessary cookies to make the site work. We'd like to set additional cookies to understand site usage and make site improvements.</span>
    <a id="cookie-notice-accept" class="btn btn-primary btn-sm">Accept Cookies</a>
    <a id="cookie-notice-deny" class="btn btn-primary btn-sm">Reject Cookies</a>
    <a href="/information/#privacy" class="btn btn-primary btn-sm">Show Cookie Purposes</a></div>
    <script>
        function createCookie(name,value,days) {
            var expires = "";
            if (days) {
                var date = new Date();
                date.setTime(date.getTime() + (days*24*60*60*1000));
                expires = "; expires=" + date.toUTCString();
            }
            document.cookie = name + "=" + value + expires + "; path=/";
        }
        function readCookie(name) {
            var nameEQ = name + "=";
            var ca = document.cookie.split(';');
            for(var i=0;i < ca.length;i++) {
                var c = ca[i];
                while (c.charAt(0)==' ') c = c.substring(1,c.length);
                if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
            }
            return null;
        }
        function eraseCookie(name) {
            createCookie(name,"",-1);
        }

        if(readCookie('cookie-notice-option')=='true') {
            
                    localStorage.setItem("doNotTrack", "0");
            
        } else if (readCookie('cookie-notice-option')!='false'){
            document.getElementById('cookie-notice').style.display = 'block';
        }

        document.getElementById('cookie-notice-accept').addEventListener("click",function() {
            createCookie('cookie-notice-option','true',31);
            document.getElementById('cookie-notice').style.display = 'none';
            location.reload();
        });

        document.getElementById('cookie-notice-deny').addEventListener("click",function() {
            createCookie('cookie-notice-option','false',31);
            document.getElementById('cookie-notice').style.display = 'none';
            location.reload();
        });
    </script>
    

<script async src="https://www.googletagmanager.com/gtag/js?id=G-EM0CM5PL0C"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EM0CM5PL0C');
</script>


<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px]" style="z-index:100">
  <div id="menu-blur" class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom bg-neutral dark:bg-neutral-800"></div>
  <div class="relative max-w-[64rem] ml-auto mr-auto">
    <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    
    
    <div>
        <a href="/" class="flex">
            <span class="sr-only">MEM v ENNBEE - Battles with Modern Endpoint Management</span>

            
            <img src="/img/logo_dk.png" width="250" height="104"
                class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt="MEM v ENNBEE - Battles with Modern Endpoint Management" />
            

        </a>
    </div>
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            

        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            
            
            
  <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Posts
    </p>
</a>



            
             
  <div>
  <div class="cursor-pointer flex items-center nested-menu">
    
    <a  class="text-base font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="">
      Topics
    </a>
    <span>
      

  <span class="relative block icon">
    <svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>

  </span>


    </span>
  </div>
  <div class="absolute menuhide">
    <div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl">
      <div class="flex flex-col space-y-3">
        
        <a href="/categories/intune/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Microsoft Intune
          </p>
        </a>
        
        <a href="/categories/windows/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Windows
          </p>
        </a>
        
        <a href="/categories/macos/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            macOS
          </p>
        </a>
        
        <a href="/categories/android/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Android
          </p>
        </a>
        
        <a href="/categories/ios/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            iOS/iPadOS
          </p>
        </a>
        
        <a href="/categories/configmgr/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Configuration Manager
          </p>
        </a>
        
      </div>
    </div>
  </div>
</div>



            
            
  <a href="https://github.com/ennnbeee/mve-scripts/"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <span >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


    </span>
    
    <p class="text-base font-medium" title="">
        
    </p>
</a>



            
            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400" style="margin-right:5px">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" class="block">
            
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:5px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">

                    <li id="menu-close-button">
                        <span
                            class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    

                    
  <li class="mt-1">
    <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Posts
        </p>
    </a>
</li>




                    

                     
  <li class="mt-1">
    <a href="" class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Topics
        </p>
        <span>
            

  <span class="relative block icon">
    <svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>

  </span>


        </span>
    </a>
</li>

<li class="mt-1">
    <a href="/categories/intune/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Microsoft Intune
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/categories/windows/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Windows
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/categories/macos/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            macOS
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/categories/android/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Android
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/categories/ios/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            iOS/iPadOS
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/categories/configmgr/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Configuration Manager
        </p>
    </a>
</li>

<li class="mb-2"></li>




                    

                    
  <li class="mt-1">
    <a href="https://github.com/ennnbeee/mve-scripts/"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <div >
            

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>


        </div>
        
        <p class="text-bg font-bg" title="">
            
        </p>
    </a>
</li>




                    

                </ul>
                
                

            </div>
        </label>
    </div>
</div>




<script>
    (function () {
        var $mainmenu = $('.main-menu');
        var path = window.location.pathname;
        $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
            $(e).children('p').addClass('active');
        });
    })();
</script>


  </div>
</div>
<script>
  window.addEventListener('scroll', function (e) {
    var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
    var background_blur = document.getElementById('menu-blur');
    background_blur.style.opacity = (scroll / 300);
  });
</script>

  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  
  
  
  
  
  




    
    <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"
    style="background-image:url(/posts/windows-cis-patching-gaps-part3/featured.png);">
    


    <div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal">
    </div>
    <div
        class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal">
    </div>
</div>

<div id="background-blur" class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div>
<script>
    window.addEventListener('scroll', function (e) {
        var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
        var background_blur = document.getElementById('background-blur');
        background_blur.style.opacity = (scroll / 300)
    });
</script>

  
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      Patching Gaps in the CIS Windows 11 Benchmark - Level 1 Windows 11
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  









  









  



<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-07-15T11:26:37&#43;01:00">15 July 2024</time><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="views_posts/Windows-CIS-Patching-Gaps-Part3/index.md" class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title="views">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
  </span>

</span>
</span><span class="px-2 text-primary-500">&middot;</span>


<script type="text/javascript" src="/js/zen-mode.min.63c8a202661f4a2063fdc2706685d668e8ea3da613da2224e9da527e5876e4f53dcac39ab60732626fb4151feae5d430d0cf44731e5d3c726522fcc1519c1547.js" integrity="sha512-Y8iiAmYfSiBj/cJwZoXWaOjqPaYT2iIk6dpSflh25PU9ysOatgcyYm&#43;0FR/q5dQw0M9Ecx5dPHJlIvzBUZwVRw=="></script>

<span class="mb-[2px]">
    <span id="zen-mode-button"
          class="text-lg hover:text-primary-500"
          title="Enable zen mode"
          data-title-i18n-disable="Enable zen mode"
          data-title-i18n-enable="Disable zen mode">
        <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="50px" height="50px">
    <path fill="currentColor" d="M 12.980469 4 C 9.1204688 4 5.9804688 7.14 5.9804688 11 L 6 26 L 9.9804688 26 L 9.9804688 11 C 9.9804688 9.35 11.320469 8 12.980469 8 L 40.019531 8 C 41.679531 8 43.019531 9.35 43.019531 11 L 43.019531 39 C 43.019531 40.65 41.679531 42 40.019531 42 L 29 42 C 29 43.54 28.420938 44.94 27.460938 46 L 40.019531 46 C 43.879531 46 47.019531 42.86 47.019531 39 L 47.019531 11 C 47.019531 7.14 43.879531 4 40.019531 4 L 12.980469 4 z M 7 28 C 4.794 28 3 29.794 3 32 L 3 42 C 3 44.206 4.794 46 7 46 L 23 46 C 25.206 46 27 44.206 27 42 L 27 32 C 27 29.794 25.206 28 23 28 L 7 28 z M 7 32 L 23 32 L 23.001953 42 L 7 42 L 7 32 z"/>
</svg>
  </span>

</span>
    </span>
</span>
  

  
  
</div>





<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/intune/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Microsoft Intune
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/windows/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Windows 10 and later
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/security/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Security
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/cis/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Center for Internet Security (CIS)
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/endpoint-security/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Endpoint Security
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/remediation/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Remediation Scripts
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/powershell/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    PowerShell
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/settings-catalog/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Settings Catalog
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/custom-profiles/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Custom Profiles
  </span>
</span>
  </span>
  
  
  
  
</div>




    </div>

    
    
    
    
    

    

    
      
      

      
        
            
              
            
          
            
          
          
<div class="flex author author-extra mt-4">
  
      
      
        
          
        
        <img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width="96" height="96"
          src="/img/ennbee_hu4969719971627417776.png" />
      
  
  <div class="place-self-center">
    
    
    <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
      Author
    </div>
    <a  href="https://memv.ennbee.uk/authors/ennbee/"  class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
      Nick Benton
    </a>
    
    
    <div class="text-sm text-neutral-700 dark:text-neutral-400">Principal Cloud Endpoint Consultant | Intune Blogger</div>
    
    <div class="text-2xl sm:text-lg">
      <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
        
        
        <a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="https://github.com/ennnbeee" target="_blank"
          aria-label="Github" rel="me noopener noreferrer"><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</span></a>
        
        
        
        <a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="https://www.linkedin.com/in/ennnbeee/" target="_blank"
          aria-label="Linkedin" rel="me noopener noreferrer"><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>

</span></a>
        
        
        
        <a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="https://learn.microsoft.com/en-us/users/ennnbeee/credentials" target="_blank"
          aria-label="Microsoft" rel="me noopener noreferrer"><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span></a>
        
        
        
        <a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="https://twitter.com/ennnbee" target="_blank"
          aria-label="Twitter" rel="me noopener noreferrer"><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>

  </span>

</span></a>
        
        
        
        <a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="https://www.youtube.com/@ennnbeee" target="_blank"
          aria-label="Youtube" rel="me noopener noreferrer"><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>

  </span>

</span></a>
        
        
        
        <a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="https://www.credly.com/users/ennnbeee" target="_blank"
          aria-label="Graduation-Cap" rel="me noopener noreferrer"><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
<path fill="currentColor" d="M320 32c-8.1 0-16.1 1.4-23.7 4.1L15.8 137.4C6.3 140.9 0 149.9 0 160s6.3 19.1 15.8 22.6l57.9 20.9C57.3 229.3 48 259.8 48 291.9v28.1c0 28.4-10.8 57.7-22.3 80.8c-6.5 13-13.9 25.8-22.5 37.6C0 442.7-.9 448.3 .9 453.4s6 8.9 11.2 10.2l64 16c4.2 1.1 8.7 .3 12.4-2s6.3-6.1 7.1-10.4c8.6-42.8 4.3-81.2-2.1-108.7C90.3 344.3 86 329.8 80 316.5V291.9c0-30.2 10.2-58.7 27.9-81.5c12.9-15.5 29.6-28 49.2-35.7l157-61.7c8.2-3.2 17.5 .8 20.7 9s-.8 17.5-9 20.7l-157 61.7c-12.4 4.9-23.3 12.4-32.2 21.6l159.6 57.6c7.6 2.7 15.6 4.1 23.7 4.1s16.1-1.4 23.7-4.1L624.2 182.6c9.5-3.4 15.8-12.5 15.8-22.6s-6.3-19.1-15.8-22.6L343.7 36.1C336.1 33.4 328.1 32 320 32zM128 408c0 35.3 86 72 192 72s192-36.7 192-72L496.7 262.6 354.5 314c-11.1 4-22.8 6-34.5 6s-23.5-2-34.5-6L143.3 262.6 128 408z"/></svg>
  </span>

</span></a>
        
        
      </div>
    </div>
  </div>
</div>


      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
     <div
      class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]">

         <details open id="TOCView"
  class="toc-right mt-0 overflow-y-scroll overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#cis-level-1-issues">CIS Level 1 Issues</a>
      <ul>
        <li><a href="#user-rights-assignment">User Rights Assignment</a></li>
        <li><a href="#miscellaneous-settings">Miscellaneous Settings</a></li>
        <li><a href="#windows-edition-requirements">Windows Edition Requirements</a></li>
        <li><a href="#user-settings">User Settings</a></li>
      </ul>
    </li>
    <li><a href="#cis-level-1-settings">CIS Level 1 Settings</a>
      <ul>
        <li><a href="#local-administrator-password-solution">Local Administrator Password Solution</a></li>
        <li><a href="#windows-updates-and-delivery-optimisation">Windows Updates and Delivery Optimisation</a></li>
        <li><a href="#microsoft-store">Microsoft Store</a></li>
        <li><a href="#windows-defender">Windows Defender</a></li>
        <li><a href="#windows-system-services">Windows System Services</a></li>
      </ul>
    </li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#cis-level-1-issues">CIS Level 1 Issues</a>
      <ul>
        <li><a href="#user-rights-assignment">User Rights Assignment</a></li>
        <li><a href="#miscellaneous-settings">Miscellaneous Settings</a></li>
        <li><a href="#windows-edition-requirements">Windows Edition Requirements</a></li>
        <li><a href="#user-settings">User Settings</a></li>
      </ul>
    </li>
    <li><a href="#cis-level-1-settings">CIS Level 1 Settings</a>
      <ul>
        <li><a href="#local-administrator-password-solution">Local Administrator Password Solution</a></li>
        <li><a href="#windows-updates-and-delivery-optimisation">Windows Updates and Delivery Optimisation</a></li>
        <li><a href="#microsoft-store">Microsoft Store</a></li>
        <li><a href="#windows-defender">Windows Defender</a></li>
        <li><a href="#windows-system-services">Windows System Services</a></li>
      </ul>
    </li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>
  </div>
</details>

<script>

  var margin = 200;
  var marginError = 50;

  (function () {
    var $window = $(window);
    var $toc = $('#TOCView');
    var tocHeight = $toc.height();

    function onResize() {
      var windowAndMarginHeight = $window.height() - margin;
      if(tocHeight >= windowAndMarginHeight) {
        $toc.css("overflow-y", "scroll")
        $toc.css("max-height", (windowAndMarginHeight + marginError) + "px")
      } else {
        $toc.css("overflow-y", "hidden")
        $toc.css("max-height", "9999999px")
      }
    }

    $window.on('resize', onResize);
    $(document).ready(onResize);
  })();



  (function () {
    var $toc = $('#TableOfContents');
    if ($toc.length > 0) {
      var $window = $(window);

      function onScroll() {
        var currentScroll = $window.scrollTop();
        var h = $('.anchor');
        var id = "";
        h.each(function (i, e) {
          e = $(e);
          if (e.offset().top - $(window).height()/3 <= currentScroll) {
            id = decodeURIComponent(e.attr('id'));
          }
        });
        var active = $toc.find('a.active');      
        if (active.length == 1 && active.eq(0).attr('href') == '#' + id) return true;

        active.each(function (i, e) {
           
            $(e).removeClass('active').siblings('ul').hide();
          
        });
        $toc.find('a[href="#' + id + '"]').addClass('active')
        $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
          $(e).children('a').parents('ul').show();          
        });
      }

      $window.on('scroll', onScroll);
      $(document).ready(function () {
         
          $toc.find('a').parent('li').find('ul').hide();
        
        onScroll();
      });
    }
  })();


</script>
   </div>
      </div>
      

      <div class="min-w-0 min-h-0 max-w-fit">
        
        
<details style="margin-left:0px" class="mt-2 mb-5 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5" >
    
    <summary
        class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-primary-800 dark:text-neutral-100">
        Patching Gaps in the CIS Windows 11 Benchmark - This article is part of a series.
    </summary>
    
    
    
    <div
        class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
        <a href="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part1/">
            Part 1: Patching Gaps in the CIS Windows 11 Benchmark - BitLocker
        </a>
    </div>
    
    
    
    <div
        class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
        <a href="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part2/">
            Part 2: Patching Gaps in the CIS Windows 11 Benchmark - Level 1 Windows Autopilot
        </a>
    </div>
    
    
    
    <div
        class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
        Part 3: This Article
    </div>
    
    
    
    <div
        class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
        <a href="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part4/">
            Part 4: Patching Gaps in the CIS Windows 11 Benchmark - Level 2 Windows 11
        </a>
    </div>
    
    


</details>



        <div class="article-content max-w-prose mb-20">
          <p>With the investigation into the impact of the CIS benchmark on <a href="/posts/windows-cis-patching-gaps-part1" rel="noopener" target="_blank">BitLocker</a> and <a href="/posts/windows-cis-patching-gaps-part2" rel="noopener" target="_blank">Windows Autopilot</a> now a fond and distant memory, it&rsquo;s time for me to stand <a href="https://www.linkedin.com/in/jonathan-fallis" target="_blank">Jonathan</a> down (it was his Birthday after all, <em>and</em> he has his own <a href="https://deploymentshare.com/" target="_blank">content</a> to create), pull up my sleeves, and get to testing the CIS Level 1 settings across the full Windows 11 operating system itself.</p>
<p>This decision to go it alone, had absolutely nothing to do with me already knowing that there were more missing settings in the benchmark <a href="/posts/windows-cis-patching-gaps-part1/#cis-build-kits" rel="noopener" target="_blank">build kit</a> than settings that actually break Windows 11, I promise 🤫.</p>
<p>So what <em>is</em> the CIS Level 1 benchmark missing?</p>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><path fill="currentColor" d="M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg>
  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >As Custom Profile settings are on their way out (see Message Centre MC822716 and this <a href="https://ourcloudnetwork.com/microsoft-to-start-blocking-custom-oma-uri-settings-in-intune/" target="_blank">post</a> by <a href="https://www.linkedin.com/in/danielbradley2/" target="_blank">Daniel Bradley</a>) this post has been updated, along with the exported profiles, to use Settings Catalog profiles.</span>
</div>



<h2 class="relative group">CIS Level 1 Issues 
    <div id="cis-level-1-issues" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#cis-level-1-issues" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Well probably a few things, but let&rsquo;s sadly look at the settings in the CIS Level 1 benchmark that are going to cause some headaches across Windows 11.</p>


<h3 class="relative group">User Rights Assignment 
    <div id="user-rights-assignment" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#user-rights-assignment" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>It looks like when configuring <a href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/security-policy-settings/user-rights-assignment" target="_blank">User Rights</a> in the Microsoft Intune benchmark, CIS &ldquo;did a Microsoft&rdquo;, and forgot that languages other than English are used across the vanilla Windows 11 operating system, just like the initial release of the <a href="https://learn.microsoft.com/en-us/mem/intune/protect/security-baseline-settings-mdm-all?pivots=mdm-23h2" target="_blank">Security Baseline for Windows 11 23H2</a> identified by <a href="https://www.linkedin.com/in/skiptotheendpoint/" target="_blank">James Robinson</a>:</p>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Trying to apply the new 23H2 <a href="https://twitter.com/hashtag/Intune?src=hash&amp;ref_src=twsrc%5Etfw">#Intune</a> Baseline and using a non-English OS? You&#39;ll probably break the ability to log into devices because the group names are localised.<a href="https://twitter.com/IntuneSuppTeam?ref_src=twsrc%5Etfw">@IntuneSuppTeam</a> These need changing to the equivalent well-known SID or a lot of devices are gonna go pop. <a href="https://t.co/zY7yWfR3yl">pic.twitter.com/zY7yWfR3yl</a></p>&mdash; James Robinson | MVP (@SkipToEndpoint) <a href="https://twitter.com/SkipToEndpoint/status/1776643614354927723?ref_src=twsrc%5Etfw">April 6, 2024</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>In short, the CIS policy uses english language names, instead of the <a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-identifiers" target="_blank">well-known SIDs</a> across all of the User Rights settings, meaning operating systems in a non-english language will hit some issues, mainly with users actually being able to logon to the device.</p>
<p>Microsoft fixed this slight oversight pretty sharpish, however the same can&rsquo;t be said for CIS 👀.</p>
<p>To give you a sample of the User Rights assignment policy, have a look at the below, covering some of the settings and associated account names in english:</p>

<div class="flex mt-2">
<span
  class="rounded-full bg-primary-500 dark:bg-primary-400 text-neutral-50 dark:text-neutral-800 px-1.5 py-[1px] text-xs font-normal"
>
  <span class="flex flex-row items-center">
    
    <span class="mr-1">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span>
    
    <span><em>CIS (L1) User Rights - Windows 11 Intune 3.0.1</em></span>
  </span>
</span>
</div>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Category</th>
          <th style="text-align: left">Setting</th>
          <th style="text-align: left">Value</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">User Rights</td>
          <td style="text-align: left">Access From Network</td>
          <td style="text-align: left"><code>Administrators, Remote Desktop Users</code></td>
      </tr>
      <tr>
          <td style="text-align: left">User Rights</td>
          <td style="text-align: left">Allow Local Log On</td>
          <td style="text-align: left"><code>Administrators, Users</code></td>
      </tr>
      <tr>
          <td style="text-align: left">User Rights</td>
          <td style="text-align: left">Create Global Objects</td>
          <td style="text-align: left"><code>Administrators, LOCAL SERVICE, NETWORK SERVICE, SERVICE</code></td>
      </tr>
      <tr>
          <td style="text-align: left">User Rights</td>
          <td style="text-align: left">Deny Access From Network</td>
          <td style="text-align: left"><code>Guests, Local account</code></td>
      </tr>
      <tr>
          <td style="text-align: left">User Rights</td>
          <td style="text-align: left">Increase Scheduling Priority</td>
          <td style="text-align: left"><code>Administrators, Window Manager\Window Manager Group</code></td>
      </tr>
  </tbody>
</table>
<p>Compared with the below extract of the updated policy, which has been amended to support the use of the SIDs:</p>

<div class="flex mt-2">
<span
  class="rounded-full bg-primary-500 dark:bg-primary-400 text-neutral-50 dark:text-neutral-800 px-1.5 py-[1px] text-xs font-normal"
>
  <span class="flex flex-row items-center">
    
    <span class="mr-1">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span>
    
    <span><em>CIS (L1) User Rights Global - Windows 11 Intune 3.0.1</em></span>
  </span>
</span>
</div>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Category</th>
          <th style="text-align: left">Setting</th>
          <th style="text-align: left">Value</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">User Rights</td>
          <td style="text-align: left">Access From Network</td>
          <td style="text-align: left"><code>*S-1-5-32-544, *S-1-5-32-555</code></td>
      </tr>
      <tr>
          <td style="text-align: left">User Rights</td>
          <td style="text-align: left">Allow Local Log On</td>
          <td style="text-align: left"><code>*S-1-5-32-544, *S-1-5-32-545</code></td>
      </tr>
      <tr>
          <td style="text-align: left">User Rights</td>
          <td style="text-align: left">Create Global Objects</td>
          <td style="text-align: left"><code>*S-1-5-32-544, *S-1-5-19, *S-1-5-20, *S-1-5-6</code></td>
      </tr>
      <tr>
          <td style="text-align: left">User Rights</td>
          <td style="text-align: left">Deny Access From Network</td>
          <td style="text-align: left"><code>*S-1-5-32-546, *S-1-5-113</code></td>
      </tr>
      <tr>
          <td style="text-align: left">User Rights</td>
          <td style="text-align: left">Increase Scheduling Priority</td>
          <td style="text-align: left"><code>*S-1-5-32-544, *S-1-5-90-0</code></td>
      </tr>
  </tbody>
</table>
<p>If we just applied and trusted CIS here, then it is quite likely that for non-English operating systems, users would not have been able to sign-in to their Windows device.</p>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >You can import the updated version of the <a href="https://github.com/ennnbeee/mve-scripts/tree/main/Intune/Configuration/CIS/Windows/L1" target="_blank">CIS (L1) User Rights Global - Windows 11 Intune 3.0.1</a> profile into your Microsoft Intune tenant instead of manually updating the profile, like we had to 🙃.</span>
</div>

<p>Edited&hellip;</p>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><path fill="currentColor" d="M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg>
  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >Thanks to <a href="https://github.com/jimmywinberg" target="_blank">Jimmy Winberg</a> in the comments, the areas in the CIS profile that reference a null identifier, have now been updated to use the <a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-identifiers#well-known-sids" target="_blank">NULL SID</a> <code>S-1-0-0</code> to stop errors in the event logs.</span>
</div>



<h3 class="relative group">Miscellaneous Settings 
    <div id="miscellaneous-settings" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#miscellaneous-settings" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p><del>These settings that exist in the benchmark document, can only, as of today, be added into Microsoft Intune using a <a href="https://learn.microsoft.com/en-us/mem/intune/configuration/custom-settings-configure" target="_blank">Custom Profile</a> which should be pretty easy (foreshadowing).</del></p>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><path fill="currentColor" d="M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg>
  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >This setting now exists within <strong>Settings Catalog</strong>, so we no longer need a Custom Profile.</span>
</div>

<p>



      <figure>
        <img
          class="my-0 rounded-md"
          loading="lazy"
          src="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/img/cis-misc_hu8069134828307592656.png"
          alt="CIS Level 1 Miscellaneous settings"
        />
        <figcaption>CIS Level 1 Miscellaneous settings document.</figcaption>
      </figure></p>
<p>So we should create a new profile to capture the three CIS Level 1 settings detailed in the document with the below Settings Catalog settings.</p>

<div class="flex mt-2">
<span
  class="rounded-full bg-primary-500 dark:bg-primary-400 text-neutral-50 dark:text-neutral-800 px-1.5 py-[1px] text-xs font-normal"
>
  <span class="flex flex-row items-center">
    
    <span class="mr-1">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span>
    
    <span><em>CIS (L1) Level 1 Misc - Windows 11 Intune 3.0.1</em></span>
  </span>
</span>
</div>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Category</th>
          <th style="text-align: left">Setting</th>
          <th style="text-align: left">Value</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Experience</td>
          <td style="text-align: left">Allow Windows Consumer Features</td>
          <td style="text-align: left"><code>Block</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Microsoft App Store</td>
          <td style="text-align: left">Block Non Admin User Install</td>
          <td style="text-align: left"><code>Allow</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Wi-Fi Settings</td>
          <td style="text-align: left">Allow Auto Connect To Wi Fi Sense Hotspots</td>
          <td style="text-align: left"><code>Block</code></td>
      </tr>
  </tbody>
</table>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >You can now import the <a href="https://github.com/ennnbeee/mve-scripts/tree/main/Intune/Configuration/CIS/Windows/L1" target="_blank">CIS (L1) Level 1 Misc - Windows 11 Intune 3.0.1</a> into your Microsoft Intune tenant instead of having to use a Custom profile.</span>
</div>

<p>For reference, the below are the legacy custom profiles settings.</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Name</th>
          <th style="text-align: left">OMA-URI</th>
          <th style="text-align: left">Data Type</th>
          <th style="text-align: left">Value</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><a href="https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-applicationmanagement#blocknonadminuserinstall" target="_blank">BlockNonAdminUserInstall</a></td>
          <td style="text-align: left"><code>./Device/Vendor/MSFT/Policy/Config/ApplicationManagement/BlockNonAdminUserInstall</code></td>
          <td style="text-align: left">Integer</td>
          <td style="text-align: left"><code>1</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-experience#allowwindowsconsumerfeatures" target="_blank">AllowWindowsConsumerFeatures</a></td>
          <td style="text-align: left"><code>./Device/Vendor/MSFT/Policy/Config/Experience/AllowWindowsConsumerFeatures</code></td>
          <td style="text-align: left">Integer</td>
          <td style="text-align: left"><code>0</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-wifi#allowautoconnecttowifisensehotspots" target="_blank">AllowAutoConnectToWiFiSenseHotspots</a></td>
          <td style="text-align: left"><code>./Device/Vendor/MSFT/Policy/Config/Wifi/AllowAutoConnectToWiFiSenseHotspots</code></td>
          <td style="text-align: left">Integer</td>
          <td style="text-align: left"><code>0</code></td>
      </tr>
  </tbody>
</table>
<p>Anyone spot a problem? I&rsquo;ll give you a minute.</p>
<p>Now we can&rsquo;t blame CIS for the issues their recommended settings cause, as this one fully goes to Microsoft. Devices getting the setting <strong>BlockNonAdminUserInstall</strong> set to enabled, causes <a href="https://www.theregister.com/2024/06/19/problems_upgrading_win_11_pro/" target="_blank">issues with the Photos app</a> on the device for devices running the <a href="https://support.microsoft.com/en-gb/topic/april-9-2024-kb5036893-os-builds-22621-3447-and-22631-3447-a674a67b-85f5-4a40-8d74-5f8af8ead5bb" target="_blank">April 2024 patch</a>.</p>

<div class="flex mt-2">
<span
  class="rounded-full bg-primary-500 dark:bg-primary-400 text-neutral-50 dark:text-neutral-800 px-1.5 py-[1px] text-xs font-normal"
>
  <span class="flex flex-row items-center">
    
    <span class="mr-1">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span>
    
    <span><em>CIS (L1) Level 1 Misc - Windows 11 Intune 3.0.1</em></span>
  </span>
</span>
</div>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Name</th>
          <th style="text-align: left">OMA-URI</th>
          <th style="text-align: left">Data Type</th>
          <th style="text-align: left">Value</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><a href="https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-applicationmanagement#blocknonadminuserinstall" target="_blank">BlockNonAdminUserInstall</a></td>
          <td style="text-align: left"><code>./Device/Vendor/MSFT/Policy/Config/ApplicationManagement/BlockNonAdminUserInstall</code></td>
          <td style="text-align: left">Integer</td>
          <td style="text-align: left"><code>1</code></td>
      </tr>
  </tbody>
</table>
<p>We also can&rsquo;t blame CIS for both <strong>AllowWindowsConsumerFeatures</strong> and <strong>BlockNonAdminUserInstall</strong> failing to apply to devices either, as due to the <a href="https://support.microsoft.com/en-gb/topic/june-11-2024-kb5039212-os-builds-22621-3737-and-22631-3737-d7f574c0-2b13-48ca-a9fc-a63093b1a2c2" target="_blank">June 2024 patch</a> devices which <em>should</em> be activated to <strong>Windows 11 Enterprise</strong> as part of subscription activation, don&rsquo;t, leaving devices at their original Windows edition, in this case Windows Pro.</p>
<p>



      <figure>
        <img
          class="my-0 rounded-md"
          loading="lazy"
          src="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/img/cis-miscerror_hu1644484624837304987.png"
          alt="CIS Level 1 Miscellaneous settings error"
        />
        <figcaption>CIS Level 1 Miscellaneous setting custom profile assignment error.</figcaption>
      </figure></p>
<p>Meaning that neither <a href="https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-experience#allowwindowsconsumerfeatures" target="_blank">AllowWindowsConsumerFeatures</a> and <a href="https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-applicationmanagement#blocknonadminuserinstall" target="_blank">BlockNonAdminUserInstall</a> will apply to non-Enterprise editions of Windows:</p>
<p>



      <figure>
        <img
          class="my-0 rounded-md"
          loading="lazy"
          src="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/img/cis-cspnonadeds_hu12552381626434528158.png"
          alt="PolicyCSP Windows Edition Settings"
        />
        <figcaption>PolicyCSP Edition settings for BlockNonAdminUserInstall</figcaption>
      </figure></p>
<p>Are there any other settings in the benchmark require specific Windows editions?</p>


<h3 class="relative group">Windows Edition Requirements 
    <div id="windows-edition-requirements" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#windows-edition-requirements" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The Windows subscription activation issues, and subsequent edition downgrade, highlighted something I hadn&rsquo;t considered, just how many settings in the CIS 3.0.1 benchmark for Level 1 actually require an Enterprise or Education editions of Windows, or at least just don&rsquo;t work on Pro editions?</p>
<p>Well I&rsquo;m not going to count them for you (I actually did, it&rsquo;s seven).</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Setting</th>
          <th style="text-align: left">Profile</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><a href="https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-experience#allowwindowsconsumerfeatures" target="_blank">AllowWindowsConsumerFeatures</a></td>
          <td style="text-align: left">CIS (L1) Level 1 Misc - Windows 11 Intune 3.0.1</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-applicationmanagement#blocknonadminuserinstall" target="_blank">BlockNonAdminUserInstall</a></td>
          <td style="text-align: left">CIS (L1) Level 1 Misc - Windows 11 Intune 3.0.1</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-experience#allowspotlightcollection" target="_blank">Allow Spotlight Collection (User)</a></td>
          <td style="text-align: left">CIS (L1) Section 22 - 80 (User) - Windows 11 Intune 3.0.1</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-experience#disableconsumeraccountstatecontent" target="_blank">Disable Consumer Account State Content</a></td>
          <td style="text-align: left">CIS (L1) Section 22 - 80 - Windows 11 Intune 3.0.1</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-applicationmanagement#requireprivatestoreonly" target="_blank">Require Private Store Only</a></td>
          <td style="text-align: left">CIS (L1) Section 22 - 80 - Windows 11 Intune 3.0.1</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-deviceguard#lsacfgflags" target="_blank">Credential Guard</a></td>
          <td style="text-align: left">CIS (L1) Virtualization Based Technology - Windows 11 Intune 3.0.1</td>
      </tr>
      <tr>
          <td style="text-align: left"><a href="https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-deviceguard#requireplatformsecurityfeatures" target="_blank">Require Platform Security Features</a></td>
          <td style="text-align: left">CIS (L1) Virtualization Based Technology - Windows 11 Intune 3.0.1</td>
      </tr>
  </tbody>
</table>
<p>If you&rsquo;ve only got devices running Windows Professional, you can say goodbye to blocking the Windows Consumer Features, or by requiring the Windows Private Store, blocking access to the store itself, or worse, device security settings in <strong>Credential Guard</strong> and <strong>Secure Boot</strong> not applying.</p>
<p>



      <figure>
        <img
          class="my-0 rounded-md"
          loading="lazy"
          src="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/img/cis-entna_hu14710464690542078079.png"
          alt="Enterprise Edition settings"
        />
        <figcaption>Settings that require Windows Enterprise editions to apply to a device.</figcaption>
      </figure></p>
<p>So this leaves a bit of a gap in the Level 1 benchmark for these Windows Professional cloud native devices, or does it?</p>
<p>Well no, we just can&rsquo;t use Microsoft Intune native settings to configure them. What we can do is use our favourite tooling <del>Group Policy</del>, PowerShell, to go and set some corresponding registry settings to ensure we&rsquo;re in-line with the benchmark.</p>
<p>We can create a PowerShell script to create the six, (yes I said six), registry settings. These exist in the <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/install/hklm-system-currentcontrolset-services-registry-tree" target="_blank">HKLM</a> registry hive, so we can happily update them using a PowerShell and a Platform Script in Microsoft Intune.</p>

<div class="flex mt-2">
<span
  class="rounded-full bg-primary-500 dark:bg-primary-400 text-neutral-50 dark:text-neutral-800 px-1.5 py-[1px] text-xs font-normal"
>
  <span class="flex flex-row items-center">
    
    <span class="mr-1">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span>
    
    <span><em>CIS (L1) Windows Pro Settings - Windows 11 Intune 3.0.1.ps1</em></span>
  </span>
</span>
</div>







  
  

  
    
  
  
  

  
  
  
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="c"># Windows Pro Device Settings</span>
</span></span><span class="line"><span class="cl"><span class="nv">$regSettings</span> <span class="p">=</span> <span class="vm">@</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nv">$regSettings</span> <span class="p">+=</span> <span class="p">[</span><span class="no">pscustomobject</span><span class="p">]</span><span class="vm">@</span><span class="p">{</span><span class="n">path</span> <span class="p">=</span> <span class="s1">&#39;HKLM:\Software\Policies\Microsoft\Windows\CloudContent&#39;</span><span class="p">;</span> <span class="n">name</span> <span class="p">=</span> <span class="s1">&#39;DisableWindowsConsumerFeatures&#39;</span><span class="p">;</span> <span class="n">value</span> <span class="p">=</span> <span class="s1">&#39;1&#39;</span><span class="p">;</span> <span class="nb">type </span><span class="p">=</span> <span class="s1">&#39;DWord&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$regSettings</span> <span class="p">+=</span> <span class="p">[</span><span class="no">pscustomobject</span><span class="p">]</span><span class="vm">@</span><span class="p">{</span><span class="n">path</span> <span class="p">=</span> <span class="s1">&#39;HKLM:\SOFTWARE\Policies\Microsoft\Windows\CloudContent&#39;</span><span class="p">;</span> <span class="n">name</span> <span class="p">=</span> <span class="s1">&#39;DisableConsumerAccountStateContent&#39;</span><span class="p">;</span> <span class="n">value</span> <span class="p">=</span> <span class="s1">&#39;1&#39;</span><span class="p">;</span> <span class="nb">type </span><span class="p">=</span> <span class="s1">&#39;DWord&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$regSettings</span> <span class="p">+=</span> <span class="p">[</span><span class="no">pscustomobject</span><span class="p">]</span><span class="vm">@</span><span class="p">{</span><span class="n">path</span> <span class="p">=</span> <span class="s1">&#39;HKLM:\Software\Policies\Microsoft\Windows\Appx&#39;</span><span class="p">;</span> <span class="n">name</span> <span class="p">=</span> <span class="s1">&#39;BlockNonAdminUserInstall&#39;</span><span class="p">;</span> <span class="n">value</span> <span class="p">=</span> <span class="s1">&#39;1&#39;</span><span class="p">;</span> <span class="nb">type </span><span class="p">=</span> <span class="s1">&#39;DWord&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$regSettings</span> <span class="p">+=</span> <span class="p">[</span><span class="no">pscustomobject</span><span class="p">]</span><span class="vm">@</span><span class="p">{</span><span class="n">path</span> <span class="p">=</span> <span class="s1">&#39;HKLM:\Software\Policies\Microsoft\WindowsStore&#39;</span><span class="p">;</span> <span class="n">name</span> <span class="p">=</span> <span class="s1">&#39;RequirePrivateStoreOnly&#39;</span><span class="p">;</span> <span class="n">value</span> <span class="p">=</span> <span class="s1">&#39;1&#39;</span><span class="p">;</span> <span class="nb">type </span><span class="p">=</span> <span class="s1">&#39;DWord&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$regSettings</span> <span class="p">+=</span> <span class="p">[</span><span class="no">pscustomobject</span><span class="p">]</span><span class="vm">@</span><span class="p">{</span><span class="n">path</span> <span class="p">=</span> <span class="s1">&#39;HKLM:\Software\Policies\Microsoft\Windows\DeviceGuard&#39;</span><span class="p">;</span> <span class="n">name</span> <span class="p">=</span> <span class="s1">&#39;LsaCfgFlags&#39;</span><span class="p">;</span> <span class="n">value</span> <span class="p">=</span> <span class="s1">&#39;1&#39;</span><span class="p">;</span> <span class="nb">type </span><span class="p">=</span> <span class="s1">&#39;DWord&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$regSettings</span> <span class="p">+=</span> <span class="p">[</span><span class="no">pscustomobject</span><span class="p">]</span><span class="vm">@</span><span class="p">{</span><span class="n">path</span> <span class="p">=</span> <span class="s1">&#39;HKLM:\Software\Policies\Microsoft\Windows\DeviceGuard&#39;</span><span class="p">;</span> <span class="n">name</span> <span class="p">=</span> <span class="s1">&#39;RequirePlatformSecurityFeatures&#39;</span><span class="p">;</span> <span class="n">value</span> <span class="p">=</span> <span class="s1">&#39;1&#39;</span><span class="p">;</span> <span class="nb">type </span><span class="p">=</span> <span class="s1">&#39;DWord&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">Try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$regSetting</span> <span class="k">in</span> <span class="nv">$regSettings</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(!(</span><span class="nb">Test-Path</span> <span class="vm">$</span><span class="p">(</span><span class="nv">$regSetting</span><span class="p">.</span><span class="n">path</span><span class="p">))){</span>
</span></span><span class="line"><span class="cl">            <span class="nb">New-Item</span> <span class="n">-Path</span> <span class="vm">$</span><span class="p">(</span><span class="nv">$regSetting</span><span class="p">.</span><span class="n">path</span><span class="p">)</span> <span class="n">-Force</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nb">New-ItemProperty</span> <span class="n">-Path</span> <span class="vm">$</span><span class="p">(</span><span class="nv">$regSetting</span><span class="p">.</span><span class="n">path</span><span class="p">)</span> <span class="n">-Name</span> <span class="vm">$</span><span class="p">(</span><span class="nv">$regSetting</span><span class="p">.</span><span class="n">name</span><span class="p">)</span> <span class="n">-Value</span> <span class="vm">$</span><span class="p">(</span><span class="nv">$regSetting</span><span class="p">.</span><span class="n">value</span><span class="p">)</span> <span class="n">-PropertyType</span> <span class="vm">$</span><span class="p">(</span><span class="nv">$regSetting</span><span class="p">.</span><span class="n">type</span><span class="p">)</span> <span class="n">-Force</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">Exit</span> <span class="mf">0</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">Catch</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Error</span> <span class="nv">$_</span><span class="p">.</span><span class="py">ErrorDetails</span>
</span></span><span class="line"><span class="cl">    <span class="n">Exit</span> <span class="mf">1</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>


<p>Sadly, the <strong>Allow Spotlight Collection</strong> setting, only exists in the <a href="https://admx.help/?Category=Windows_11_2022&amp;Policy=Microsoft.Policies.CloudContent::DisableSpotlightCollectionOnDesktop" target="_blank">HKCU</a> part of the registry, and sits under the <strong>HKCU:\Software\Policies</strong> key which standard users don&rsquo;t have access to write to. So we don&rsquo;t have a way to create this new item using PowerShell and Platform Scripts natively.</p>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><path fill="currentColor" d="M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg>
  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >Jonathan has informed me that you could apply the <strong>Allow Spotlight Collection</strong> setting in <strong>HKCU</strong> using the <a href="https://psappdeploytoolkit.com/" target="_blank">PSAppDeployToolkit</a>, specifically the <a href="https://psappdeploytoolkit.com/docs/reference/functions/Invoke-HKCURegistrySettingsForAllUsers/" target="_blank">Invoke-HKCURegistrySettingsForAllUsers</a> functionality, so off you trot and do that.</span>
</div>

<p>The rest of registry entries in <strong>CIS (L1) Windows Pro Settings - Windows 11 Intune 3.0.1.ps1</strong> are fine, so deploy them to your devices using a Platform Script:</p>
<p>



      <figure>
        <img
          class="my-0 rounded-md"
          loading="lazy"
          src="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/img/cis-entscript_hu5978309743560195609.png"
          alt="CIS (L1) Windows Pro Settings - Windows 11 Intune 3.0.1.ps1"
        />
        <figcaption>Platform Script configuring Windows Enterprise only Policy CSP Settings.</figcaption>
      </figure></p>
<p>Using Platform Scripts, we&rsquo;re currently limited to assignments without <a href="https://learn.microsoft.com/en-us/mem/intune/fundamentals/filters" target="_blank">Device Filters</a>, so we don&rsquo;t have a way to target just Windows devices that aren&rsquo;t on Windows 11 Enterprise/Education (operating system edition isn&rsquo;t an attribute stored in the Entra ID computer object, so no Dynamic Groups either).</p>
<p>Seeing the script do it&rsquo;s thing, we now have the configured registry settings, (at least those in HKLM), set on the device, with the expected behaviour of the CIS benchmark:</p>
<p>



      <figure>
        <img
          class="my-0 rounded-md"
          loading="lazy"
          src="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/img/cis-regcloudcontent_hu4527084153654474353.png"
          alt="Windows Pro registry settings"
        />
        <figcaption>Windows Pro registry settings under HKLM:\Software\Policies\Microsoft\Windows\CloudContent.</figcaption>
      </figure></p>
<p>



      <figure>
        <img
          class="my-0 rounded-md"
          loading="lazy"
          src="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/img/cis-regappx_hu17182513558852458787.png"
          alt="Windows Pro registry settings"
        />
        <figcaption>Windows Pro registry settings under HKLM:\Software\Policies\Microsoft\Windows\Appx.</figcaption>
      </figure></p>
<p>



      <figure>
        <img
          class="my-0 rounded-md"
          loading="lazy"
          src="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/img/cis-regwindowsstore_hu3624388972057411317.png"
          alt="Windows Pro registry settings"
        />
        <figcaption>Windows Pro registry settings under HKLM:\Software\Policies\Microsoft\WindowsStore.</figcaption>
      </figure></p>
<p>



      <figure>
        <img
          class="my-0 rounded-md"
          loading="lazy"
          src="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/img/cis-regdeviceguard_hu8395648166255948445.png"
          alt="Windows Pro registry settings"
        />
        <figcaption>Windows Pro registry settings under HKLM:\Software\Policies\Microsoft\Windows\DeviceGuard.</figcaption>
      </figure></p>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >The <a href="https://github.com/ennnbeee/mve-scripts/blob/main/Intune/PlatformScripts/PowerShell/CIS/L1/" target="_blank">CIS (L1) Windows Pro Settings - Windows 11 Intune 3.0.1.ps1</a> PowerShell scripts should be added as Platform scripts in Microsoft Intune.</span>
</div>



<h3 class="relative group">User Settings 
    <div id="user-settings" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#user-settings" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Any other assignment issues you want to throw our way and not document CIS? No? Are you sure?</p>
<p>Having reviewed the device assignment states after by default assigning the imported build kit settings to groups of devices in Microsoft Intune, I was left pondering as to why CIS wouldn&rsquo;t mention that there are User only settings in each of the profiles.</p>
<p>



      <figure>
        <img
          class="my-0 rounded-md"
          loading="lazy"
          src="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/img/cis-userna_hu7130290139125724650.png"
          alt="User Settings Not Applicable"
        />
        <figcaption>User Only settings not applying to the device context in Microsoft Intune.</figcaption>
      </figure></p>
<p>This isn&rsquo;t such a bad thing, as you&rsquo;re just going to get a <strong>Not Applicable</strong> state when assigned to the SYSTEM context of the device, the user on the device will be fine though.</p>
<p>However, for good practice assignment, we should split out the user settings from the profiles, and create new ones, allowing a consistent assignment of settings.</p>

<div class="flex mt-2">
<span
  class="rounded-full bg-primary-500 dark:bg-primary-400 text-neutral-50 dark:text-neutral-800 px-1.5 py-[1px] text-xs font-normal"
>
  <span class="flex flex-row items-center">
    
    <span class="mr-1">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span>
    
    <span><em>CIS (L1) Admin Templates - Windows Components (User) - Windows 11 Intune 3.0.1</em></span>
  </span>
</span>
</div>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Category</th>
          <th style="text-align: left">Setting</th>
          <th style="text-align: left">Value</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Administrative Templates &gt; Windows Components &gt; Network Sharing</td>
          <td style="text-align: left">Prevent users from sharing files within their profile. (User)</td>
          <td style="text-align: left"><code>Enabled</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Administrative Templates &gt; Windows Components &gt; Attachment Manager</td>
          <td style="text-align: left">Do not preserve zone information in file attachments (User)</td>
          <td style="text-align: left"><code>Disabled</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Administrative Templates &gt; Windows Components &gt; Attachment Manager</td>
          <td style="text-align: left">Notify antivirus programs when opening attachments (User)</td>
          <td style="text-align: left"><code>Enabled</code></td>
      </tr>
  </tbody>
</table>

<div class="flex mt-2">
<span
  class="rounded-full bg-primary-500 dark:bg-primary-400 text-neutral-50 dark:text-neutral-800 px-1.5 py-[1px] text-xs font-normal"
>
  <span class="flex flex-row items-center">
    
    <span class="mr-1">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span>
    
    <span><em>CIS (L1) Section 22 - 80 (User) - Windows 11 Intune 3.0.1</em></span>
  </span>
</span>
</div>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Category</th>
          <th style="text-align: left">Setting</th>
          <th style="text-align: left">Value</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Experience</td>
          <td style="text-align: left">Allow Spotlight Collection (User)</td>
          <td style="text-align: left"><code>0</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Microsoft App Store</td>
          <td style="text-align: left">MSI Always Install With Elevated Privileges (User)</td>
          <td style="text-align: left"><code>Disabled</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Administrative Templates &gt; Windows Components &gt; Attachment Manager</td>
          <td style="text-align: left">Notify antivirus programs when opening attachments (User)</td>
          <td style="text-align: left"><code>Enabled</code></td>
      </tr>
  </tbody>
</table>

<div class="flex mt-2">
<span
  class="rounded-full bg-primary-500 dark:bg-primary-400 text-neutral-50 dark:text-neutral-800 px-1.5 py-[1px] text-xs font-normal"
>
  <span class="flex flex-row items-center">
    
    <span class="mr-1">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span>
    
    <span><em>CIS (L1) Section 1 - 3.9.1.1 (User) - Windows 11 Intune 3.0.1</em></span>
  </span>
</span>
</div>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Category</th>
          <th style="text-align: left">Setting</th>
          <th style="text-align: left">Value</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Administrative Templates &gt; Start Menu and Taskbar &gt; Notifications</td>
          <td style="text-align: left">Turn off toast notifications on the lock screen (User)</td>
          <td style="text-align: left"><code>Enabled</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Administrative Templates &gt; Control Panel &gt; Personalization</td>
          <td style="text-align: left">Enable screen saver (User)</td>
          <td style="text-align: left"><code>Enabled</code></td>
      </tr>
  </tbody>
</table>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >The amended profiles and the new user based profiles, <a href="https://github.com/ennnbeee/mve-scripts/tree/main/Intune/Configuration/CIS/Windows/L1" target="_blank">CIS (L1) Admin Templates - Windows Components (User) - Windows 11 Intune 3.0.1</a>, <a href="https://github.com/ennnbeee/mve-scripts/tree/main/Intune/Configuration/CIS/Windows/L1" target="_blank">CIS (L1) Section 22 - 80 (User) - Windows 11 Intune 3.0.1</a> and <a href="https://github.com/ennnbeee/mve-scripts/tree/main/Intune/Configuration/CIS/Windows/L1" target="_blank">CIS (L1) Section 1 - 3.9.1.1 (User) - Windows 11 Intune 3.0.1</a> are available for you to import, don&rsquo;t say I&rsquo;m not kind to you all.</span>
</div>



<h2 class="relative group">CIS Level 1 Settings 
    <div id="cis-level-1-settings" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#cis-level-1-settings" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Now hopefully we&rsquo;re done with settings in the Level 1 benchmark that just don&rsquo;t work properly, we can look at settings that are missing, or settings that are just going to annoy your end-users or support teams 🫠.</p>


<h3 class="relative group">Local Administrator Password Solution 
    <div id="local-administrator-password-solution" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#local-administrator-password-solution" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>On to recommendations that exist in the Benchmark <a href="https://www.cisecurity.org/benchmark/intune" target="_blank">document</a> but not in the build kit, we can start with <a href="https://learn.microsoft.com/en-us/windows-server/identity/laps/laps-overview" target="_blank">Windows LAPS</a>.</p>
<p>The Windows LAPS settings don&rsquo;t exist in the build kit as it&rsquo;s configured under <a href="https://learn.microsoft.com/en-us/mem/intune/protect/endpoint-security-account-protection-policy" target="_blank">Account Protection</a> in the <a href="https://learn.microsoft.com/en-us/mem/intune/protect/endpoint-security-policy" target="_blank">Endpoint Security</a> section of Microsoft Intune, so I assume CIS just didn&rsquo;t include it as there is no native import functionality.</p>
<p>Taking the information provided in the benchmark document, we need to cover off everything under section <strong>85 Windows LAPS</strong>, as they&rsquo;re all CIS Level 1 settings.</p>
<p>



      <figure>
        <img
          class="my-0 rounded-md"
          loading="lazy"
          src="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/img/cis-laps_hu8239358560181075392.png"
          alt="CIS Section 85 Settings"
        />
        <figcaption>An excerpt from the CIS 3.0.1 benchmark for Windows LAPS.</figcaption>
      </figure></p>
<p>We can easily create a new <strong>Account Protection</strong> policy in Microsoft Intune to meet these requirements, with the settings below:</p>

<div class="flex mt-2">
<span
  class="rounded-full bg-primary-500 dark:bg-primary-400 text-neutral-50 dark:text-neutral-800 px-1.5 py-[1px] text-xs font-normal"
>
  <span class="flex flex-row items-center">
    
    <span class="mr-1">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span>
    
    <span><em>CIS (L1) Windows LAPS - Windows 11 Intune 3.0.1</em></span>
  </span>
</span>
</div>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Category</th>
          <th style="text-align: left">Setting</th>
          <th style="text-align: left">Value</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">LAPS</td>
          <td style="text-align: left">Backup Directory</td>
          <td style="text-align: left"><code>Backup the password to Azure AD only</code></td>
      </tr>
      <tr>
          <td style="text-align: left">LAPS</td>
          <td style="text-align: left">Password Age Days</td>
          <td style="text-align: left"><code>30 or fewer</code><sup><strong>*</strong></sup></td>
      </tr>
      <tr>
          <td style="text-align: left">LAPS</td>
          <td style="text-align: left">Administrator Account Name</td>
          <td style="text-align: left"><code>Admin</code></td>
      </tr>
      <tr>
          <td style="text-align: left">LAPS</td>
          <td style="text-align: left">Password Complexity</td>
          <td style="text-align: left"><code>Large letters + small letters + numbers + special characters (improved readability)</code></td>
      </tr>
      <tr>
          <td style="text-align: left">LAPS</td>
          <td style="text-align: left">Password Length</td>
          <td style="text-align: left"><code>15 or more</code><sup><strong>*</strong></sup></td>
      </tr>
      <tr>
          <td style="text-align: left">LAPS</td>
          <td style="text-align: left">Post Authentication Actions</td>
          <td style="text-align: left"><code>Reset the password and logoff the managed account (or higher)</code><sup><strong>*</strong></sup></td>
      </tr>
      <tr>
          <td style="text-align: left">LAPS</td>
          <td style="text-align: left">Post Authentication Reset Delay</td>
          <td style="text-align: left"><code>8 (or fewer hours, but not 0)</code><sup><strong>*</strong></sup></td>
      </tr>
  </tbody>
</table>
<p><sup>*</sup><em>These are the minimum settings to adhere to the CIS benchmark, so amend as you see fit.</em></p>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >Don&rsquo;t forget if you are going to use Windows LAPS, that you <a href="https://learn.microsoft.com/en-us/entra/identity/devices/howto-manage-local-admin-passwords#enabling-windows-laps-with-microsoft-entra-id" target="_blank">enable</a> the feature in Entra ID, and review the <a href="https://learn.microsoft.com/en-us/windows-server/identity/laps/laps-overview" target="_blank">requirements</a> to allow you to actually use it on your Windows 11 devices.</span>
</div>

<p>The <strong>CIS (L1) Local Policies Security Options - Windows 11 Intune 3.0.1</strong> CIS policy sets the built-in administrator account name to <strong>Admin</strong>, so make sure either you update the setting below in the imported policy to match any changes to the LAPS setting, or be happy with what it&rsquo;s called:</p>

<div class="flex mt-2">
<span
  class="rounded-full bg-primary-500 dark:bg-primary-400 text-neutral-50 dark:text-neutral-800 px-1.5 py-[1px] text-xs font-normal"
>
  <span class="flex flex-row items-center">
    
    <span class="mr-1">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span>
    
    <span><em>CIS (L1) Local Policies Security Options - Windows 11 Intune 3.0.1</em></span>
  </span>
</span>
</div>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Category</th>
          <th style="text-align: left">Setting</th>
          <th style="text-align: left">Value</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Local Policies Security Options</td>
          <td style="text-align: left">Accounts Rename Administrator Account</td>
          <td style="text-align: left"><code>Admin</code></td>
      </tr>
  </tbody>
</table>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >We can&rsquo;t export a Endpoint Security profile, even if they&rsquo;re technically Settings Catalog profiles, so we&rsquo;re using the <a href="https://github.com/Micke-K/IntuneManagement" target="_blank">Intune Management</a> tool, allowing you to import the <a href="https://github.com/ennnbeee/mve-scripts/tree/main/Intune/Configuration/CIS/Windows/L1" target="_blank">CIS (L1) Windows LAPS - Windows 11 Intune 3.0.1</a> profile instead of having to create it.</span>
</div>



<h3 class="relative group">Windows Updates and Delivery Optimisation 
    <div id="windows-updates-and-delivery-optimisation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#windows-updates-and-delivery-optimisation" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Is it all good in the world of Windows Update for Business settings in the CIS benchmark? Well kind of, if you want all of your devices to install updates every day, with no phasing, and just blindly update to the latest Feature Update after 180 days.</p>

<div class="flex mt-2">
<span
  class="rounded-full bg-primary-500 dark:bg-primary-400 text-neutral-50 dark:text-neutral-800 px-1.5 py-[1px] text-xs font-normal"
>
  <span class="flex flex-row items-center">
    
    <span class="mr-1">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span>
    
    <span><em>CIS (L1) Windows Update - Windows 11 Intune 3.0.1</em></span>
  </span>
</span>
</div>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Category</th>
          <th style="text-align: left">Setting</th>
          <th style="text-align: left">Value</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Windows Update For Business</td>
          <td style="text-align: left">Defer Feature Updates Period In Days</td>
          <td style="text-align: left"><code>180</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Windows Update For Business</td>
          <td style="text-align: left">Defer Quality Updates Period (Days)</td>
          <td style="text-align: left"><code>0</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Windows Update For Business</td>
          <td style="text-align: left">Scheduled Install Day</td>
          <td style="text-align: left"><code>Every day</code></td>
      </tr>
  </tbody>
</table>
<p>It&rsquo;s not like there&rsquo;s even much room for manoeuvre; the Feature Update deferral is a <em>minimum</em> of 180 days, so you could phase the delivery of Feature Updates at least, but the Quality Update deferral can only be zero days, so out goes the window for any kind of <a href="/posts/flexible-update-deployments/" rel="noopener" target="_blank">phasing</a>.</p>
<p>Maybe CIS has more faith in Windows Updates not breaking devices than others 🫢.</p>
<p>At least there&rsquo;s a setting in the build kit for <a href="https://learn.microsoft.com/en-us/mem/intune/configuration/delivery-optimization-windows" target="_blank">Delivery Optimisation</a>, so all our devices installing Quality and Feature updates at the same time don&rsquo;t smash the WAN connection to bits&hellip;</p>

<div class="flex mt-2">
<span
  class="rounded-full bg-primary-500 dark:bg-primary-400 text-neutral-50 dark:text-neutral-800 px-1.5 py-[1px] text-xs font-normal"
>
  <span class="flex flex-row items-center">
    
    <span class="mr-1">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span>
    
    <span><em>CIS (L1) Section 22 - 80 - Windows 11 Intune 3.0.1</em></span>
  </span>
</span>
</div>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Category</th>
          <th style="text-align: left">Setting</th>
          <th style="text-align: left">Value</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Delivery Optimization</td>
          <td style="text-align: left">DO Download Mode</td>
          <td style="text-align: left"><code>HTTP only, no peering</code></td>
      </tr>
  </tbody>
</table>
<p>Oh.</p>
<p>It&rsquo;s OK, we can have any of the settings available to us in Microsoft Intune, just not <strong>HTTP blended with Internet peering.</strong></p>
<p>



      <figure>
        <img
          class="my-0 rounded-md"
          loading="lazy"
          src="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/img/cis-docdo_hu10562045219450728109.png"
          alt="CIS Delivery Optimisation Settings"
        />
        <figcaption>Section 22.1 (L1) Ensure &lsquo;DO Download Mode&rsquo; is NOT set to &lsquo;HTTP blended with Internet Peering&rsquo;.</figcaption>
      </figure></p>
<p>Just goes to show that you do really need to read the associated CIS Benchmark document along with using the build kit, or just take the word of someone on the internet that things work 😬.</p>


<h3 class="relative group">Microsoft Store 
    <div id="microsoft-store" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#microsoft-store" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>As mentioned previously, having a Microsoft Intune setting to <strong>Require Private Store Only</strong> is only a Windows Enterprise edition feature, however we sorted that with the PowerShell script, so now that the setting is applying to all devices correctly, it blocks the store.</p>

<div class="flex mt-2">
<span
  class="rounded-full bg-primary-500 dark:bg-primary-400 text-neutral-50 dark:text-neutral-800 px-1.5 py-[1px] text-xs font-normal"
>
  <span class="flex flex-row items-center">
    
    <span class="mr-1">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span>
    
    <span><em>CIS (L1) Section 22 - 80 - Windows 11 Intune 3.0.1</em></span>
  </span>
</span>
</div>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Category</th>
          <th style="text-align: left">Setting</th>
          <th style="text-align: left">Value</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Microsoft App Store</td>
          <td style="text-align: left">Require Private Store Only</td>
          <td style="text-align: left"><code>Only Private store is enabled.</code></td>
      </tr>
  </tbody>
</table>
<p>As there isn&rsquo;t such as thing as a Private Store now the the <a href="https://learn.microsoft.com/en-us/microsoft-store/" target="_blank">Microsoft Store for Business</a> has been retired (has it?), then the outcome of the setting above just blocks access to the store.</p>
<p>



      <figure>
        <img
          class="my-0 rounded-md"
          loading="lazy"
          src="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/img/cis-storeblocked_hu6098444646772484740.png"
          alt="Blocked Microsoft Store"
        />
        <figcaption>The Microsoft Store blocked by the Require Private Store setting in Microsoft Intune.</figcaption>
      </figure></p>
<p>In the same profile though at least the store apps are being kept up to date:</p>

<div class="flex mt-2">
<span
  class="rounded-full bg-primary-500 dark:bg-primary-400 text-neutral-50 dark:text-neutral-800 px-1.5 py-[1px] text-xs font-normal"
>
  <span class="flex flex-row items-center">
    
    <span class="mr-1">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span>
    
    <span><em>CIS (L1) Section 22 - 80 - Windows 11 Intune 3.0.1</em></span>
  </span>
</span>
</div>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Category</th>
          <th style="text-align: left">Setting</th>
          <th style="text-align: left">Value</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Microsoft App Store</td>
          <td style="text-align: left">Allow apps from the Microsoft app store to auto update</td>
          <td style="text-align: left"><code>Allowed.</code></td>
      </tr>
  </tbody>
</table>
<p>But with no way easy way to check that apps are actually being updated, you&rsquo;d better look at another option to ensure the built-in apps are <a href="/posts/updating-windows-store-apps/" rel="noopener" target="_blank">kept up to date</a> 😉.</p>


<h3 class="relative group">Windows Defender 
    <div id="windows-defender" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#windows-defender" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>You&rsquo;d think there&rsquo;d be nothing majorly wrong with the <a href="https://www.microsoft.com/en-gb/windows/comprehensive-security" target="_blank">Windows Defender</a> settings in the build kit, or the benchmark document itself, and on first glance all looks well apart from the lack of any kind <a href="https://learn.microsoft.com/en-us/mem/intune/protect/antivirus-microsoft-defender-settings-windows#remediation" target="_blank">remediations</a> to quarantine or delete detected threats.</p>
<p>You might not be using Windows Defender as your primary antivirus solution, so CIS not assuming you are is a good thing.</p>
<p>But based on this, CIS wouldn&rsquo;t include anything in the imported profiles that <em>does</em> require Windows Defender to be acting a as primary solution and/or in active mode though?</p>

<div class="flex mt-2">
<span
  class="rounded-full bg-primary-500 dark:bg-primary-400 text-neutral-50 dark:text-neutral-800 px-1.5 py-[1px] text-xs font-normal"
>
  <span class="flex flex-row items-center">
    
    <span class="mr-1">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span>
    
    <span><em>CIS (L1) Defender - Windows 11 Intune 3.0.1</em></span>
  </span>
</span>
</div>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Category</th>
          <th style="text-align: left">Setting</th>
          <th style="text-align: left">Value</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Defender</td>
          <td style="text-align: left">Block executable content from email client and webmail</td>
          <td style="text-align: left"><code>Block</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Defender</td>
          <td style="text-align: left">Block Office applications from injecting code into other processes</td>
          <td style="text-align: left"><code>Block</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Defender</td>
          <td style="text-align: left">Block Office applications from creating executable content</td>
          <td style="text-align: left"><code>Block</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Defender</td>
          <td style="text-align: left">Block abuse of exploited vulnerable signed drivers (Device)</td>
          <td style="text-align: left"><code>Block</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Defender</td>
          <td style="text-align: left">Block persistence through WMI event subscription</td>
          <td style="text-align: left"><code>Block</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Defender</td>
          <td style="text-align: left">Block untrusted and unsigned processes that run from USB</td>
          <td style="text-align: left"><code>Block</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Defender</td>
          <td style="text-align: left">Block JavaScript or VBScript from launching downloaded executable content</td>
          <td style="text-align: left"><code>Block</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Defender</td>
          <td style="text-align: left">Block credential stealing from the Windows local security authority subsystem</td>
          <td style="text-align: left"><code>Block</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Defender</td>
          <td style="text-align: left">Block Adobe Reader from creating child processes</td>
          <td style="text-align: left"><code>Block</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Defender</td>
          <td style="text-align: left">Block all Office applications from creating child processes</td>
          <td style="text-align: left"><code>Block</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Defender</td>
          <td style="text-align: left">Block Office communication application from creating child processes</td>
          <td style="text-align: left"><code>Block</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Defender</td>
          <td style="text-align: left">Block Win32 API calls from Office macros</td>
          <td style="text-align: left"><code>Block</code></td>
      </tr>
      <tr>
          <td style="text-align: left">Defender</td>
          <td style="text-align: left">Block execution of potentially obfuscated scripts</td>
          <td style="text-align: left"><code>Block</code></td>
      </tr>
  </tbody>
</table>
<p>Ah, <strong>13</strong> <a href="https://learn.microsoft.com/en-us/defender-endpoint/attack-surface-reduction-rules-deployment" target="_blank">Attack Surface Reduction Rules</a>, and all in <strong>block</strong> mode 


    
    
    
    
    
        
            
        
    

    

    
        
        <img src="/emoji/pikachu_face.png" alt="pikachu_face" title="pikachu_face" class="emoji">
    



, not an <a href="https://learn.microsoft.com/en-gb/defender-endpoint/attack-surface-reduction?WT.mc_id=Portal-fx#audit-mode-for-evaluation" target="_blank">audit</a> setting in sight. Brilliant.</p>
<p>So even if you do meet the <a href="https://learn.microsoft.com/en-us/defender-endpoint/attack-surface-reduction-rules-deployment#attack-surface-reduction-rules-dependencies" target="_blank">dependencies</a> below for the ASR rules to actually apply, they&rsquo;re all going to straight up block everything they find that matches the rules.</p>
<blockquote>
<p>Microsoft Defender Antivirus must be enabled and configured as primary anti-virus solution, and must be in the following mode:</p>
<ul>
<li>Primary antivirus/antimalware solution</li>
<li>State: Active mode</li>
</ul>
</blockquote>
<p>Which is another good reason to actually check to see what these build kit profiles are configuring, without blindly applying them to you device estate and being all surprised when stuff stops working.</p>


<h3 class="relative group">Windows System Services 
    <div id="windows-system-services" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#windows-system-services" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>CIS provide a PowerShell script as part of the Level 1 benchmark to disable some <del>scary looking</del> Windows System Services, specifically the below (even if the Xbox ones are already disabled by <strong>CIS (L1) System Services - Windows 11 Intune 3.0.1</strong>).</p>
<p>The table below details the apparent effect of disabling these services.</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Service Name</th>
          <th style="text-align: left">Service Description</th>
          <th style="text-align: left">Impact</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>Browser</code></td>
          <td style="text-align: left">Computer Browser</td>
          <td style="text-align: left">No more discovery of network devices.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>IISADMIN</code></td>
          <td style="text-align: left">IIS Admin Service</td>
          <td style="text-align: left">No SMTP or FTP configuration in IIS.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>irmon</code></td>
          <td style="text-align: left">Infrared monitor service</td>
          <td style="text-align: left">No transfer of data using Infrared.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>SharedAccess</code></td>
          <td style="text-align: left">Internet Connection Sharing</td>
          <td style="text-align: left">No sharing of network connections, bye bye Hyper-V bridging.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>LxssManager</code></td>
          <td style="text-align: left">LxssManager</td>
          <td style="text-align: left">Bye bye Windows Subsystem for Linux.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>FTPSVC</code></td>
          <td style="text-align: left">Microsoft FTP Service</td>
          <td style="text-align: left">Clearly no more FTP servers.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>sshd</code></td>
          <td style="text-align: left">OpenSSH SSH Server</td>
          <td style="text-align: left">Same as above but SSH servers.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>RpcLocator</code></td>
          <td style="text-align: left">Remote Procedure Call (RPC) Locator</td>
          <td style="text-align: left">Nowt, legacy service.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>RemoteAccess</code></td>
          <td style="text-align: left">Routing and Remote Access</td>
          <td style="text-align: left">As on the tin, used for RRAS servers.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>simptcp</code></td>
          <td style="text-align: left">Simple TCP/IP LocalServices$LocalServices</td>
          <td style="text-align: left">Apparently has little use in modern environments, and is an optional Windows feature.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>sacsvr</code></td>
          <td style="text-align: left">Special Administration Console Helper</td>
          <td style="text-align: left">Remote command prompt used as part of Windows Emergency Management Services and Serial Console.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>SSDPSRV</code></td>
          <td style="text-align: left">SSDP Discovery</td>
          <td style="text-align: left">UPnP device discovery is now dead.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>upnphost</code></td>
          <td style="text-align: left">UPnP Device Host</td>
          <td style="text-align: left">UPnP device discovery is still dead.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>WMSvc</code></td>
          <td style="text-align: left">Web Management Service</td>
          <td style="text-align: left">No more management of local web servers.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>WMPNetworkSvc</code></td>
          <td style="text-align: left">Windows Media Player Network Sharing Service</td>
          <td style="text-align: left">No media sharing from Windows Media Player.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>icssvc</code></td>
          <td style="text-align: left">Windows Mobile Hotspot Service</td>
          <td style="text-align: left">No creation of Mobile hotspots.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>W3SVC</code></td>
          <td style="text-align: left">World Wide Web Publishing Service</td>
          <td style="text-align: left">No more local web servers.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>XboxGipSvc</code></td>
          <td style="text-align: left">Xbox Accessory Management Service</td>
          <td style="text-align: left">No playing games.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>XblAuthManager</code></td>
          <td style="text-align: left">Xbox Live Auth Manager</td>
          <td style="text-align: left">No logging into games.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>XblGameSave</code></td>
          <td style="text-align: left">Xbox Live Game Save</td>
          <td style="text-align: left">No saving games.</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>XboxNetApiSvc</code></td>
          <td style="text-align: left">Xbox Live Networking Service</td>
          <td style="text-align: left">No games.</td>
      </tr>
  </tbody>
</table>
<p>So happy with all the functionality that is being prevented, we can deploy the provided script using Microsoft Intune Platform Scripts with deployment settings looking something like this:</p>
<p>



      <figure>
        <img
          class="my-0 rounded-md"
          loading="lazy"
          src="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/img/cis-l1script_hu16596471409951676888.png"
          alt="CIS Level 1 System Services Script"
        />
        <figcaption>CIS Level 1 services PowerShell Script in Microsoft Intune.</figcaption>
      </figure></p>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >The PowerShell Script <a href="https://github.com/ennnbeee/mve-scripts/tree/main/Intune/PlatformScripts/PowerShell/CIS/L1" target="_blank">CIS (L1) System Services - Windows 11 Intune 3.0.1</a> is available to download and add as a new Platform Script to Microsoft Intune.</span>
</div>

<p>Now this is all well and good for disabling the services, <em>once</em>, but what happens if someone manages to enable them after the script has run, now what?</p>
<p>Well <a href="https://learn.microsoft.com/en-us/mem/intune/fundamentals/remediations" target="_blank">Remediations</a> that&rsquo;s what.</p>
<p>A quick modification to the existing script, to use some logic round how many of the services are not currently disabled, passing this back to Microsoft Intune as part of a detection script:</p>

<div class="flex mt-2">
<span
  class="rounded-full bg-primary-500 dark:bg-primary-400 text-neutral-50 dark:text-neutral-800 px-1.5 py-[1px] text-xs font-normal"
>
  <span class="flex flex-row items-center">
    
    <span class="mr-1">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span>
    
    <span><em>CIS (L1) System Services - Windows 11 Intune 3.0.1_Detection.ps1</em></span>
  </span>
</span>
</div>







  
  

  
    
  
  
  

  
  
  
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="nv">$cisServices</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;Browser&#39;</span><span class="p">,</span> <span class="c"># Computer Browser</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;IISADMIN&#39;</span><span class="p">,</span> <span class="c"># IIS Admin Service</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;irmon&#39;</span><span class="p">,</span> <span class="c"># Infrared monitor service</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;SharedAccess&#39;</span><span class="p">,</span> <span class="c"># Internet Connection Sharing</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;LxssManager&#39;</span><span class="p">,</span> <span class="c"># LxssManager</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;FTPSVC&#39;</span><span class="p">,</span> <span class="c"># Microsoft FTP Service</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;sshd&#39;</span><span class="p">,</span> <span class="c"># OpenSSH SSH Server</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;RpcLocator&#39;</span><span class="p">,</span> <span class="c"># Remote Procedure Call (RPC) Locator</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;RemoteAccess&#39;</span><span class="p">,</span> <span class="c"># Routing and Remote Access</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;simptcp&#39;</span><span class="p">,</span> <span class="c"># Simple TCP/IP LocalServices$LocalServices</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;sacsvr&#39;</span><span class="p">,</span> <span class="c"># Special Administration Console Helper</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;SSDPSRV&#39;</span><span class="p">,</span> <span class="c"># SSDP Discovery</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;upnphost&#39;</span><span class="p">,</span> <span class="c"># UPnP Device Host</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;WMSvc&#39;</span><span class="p">,</span> <span class="c"># Web Management Service</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;WMPNetworkSvc&#39;</span><span class="p">,</span> <span class="c"># Windows Media Player Network Sharing Service</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;icssvc&#39;</span><span class="p">,</span> <span class="c"># Windows Mobile Hotspot Service</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;W3SVC&#39;</span><span class="p">,</span> <span class="c"># World Wide Web Publishing Service</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;XboxGipSvc&#39;</span><span class="p">,</span> <span class="c"># Xbox Accessory Management Service</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;XblAuthManager&#39;</span><span class="p">,</span> <span class="c"># Xbox Live Auth Manager</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;XblGameSave&#39;</span><span class="p">,</span> <span class="c"># Xbox Live Game Save</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;XboxNetApiSvc&#39;</span> <span class="c"># Xbox Live Networking Service</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Get current state on the services in the array above.</span>
</span></span><span class="line"><span class="cl"><span class="nv">$localServices</span> <span class="p">=</span> <span class="nb">Get-Service</span> <span class="n">-Name</span> <span class="nv">$cisServices</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>
</span></span><span class="line"><span class="cl"><span class="nv">$notDisabled</span> <span class="p">=</span> <span class="mf">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$cisService</span> <span class="k">in</span> <span class="nv">$cisServices</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Make sure service name in the list matches with local system services.</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Added because of Computer Browser mismatch with &#34;bowser&#34; service</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$foundService</span> <span class="p">=</span> <span class="nv">$localServices</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="py">Name</span> <span class="o">-eq</span> <span class="nv">$cisService</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$foundService</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$foundService</span><span class="p">.</span><span class="py">StartType</span> <span class="o">-ne</span> <span class="s1">&#39;Disabled&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$notDisabled</span><span class="p">++</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$notDisabled</span> <span class="o">-gt</span> <span class="mf">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Output</span> <span class="s2">&#34;Found </span><span class="nv">$notDisabled</span><span class="s2"> service(s) that should be disabled for CIS Level 1.&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Exit</span> <span class="mf">1</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Output</span> <span class="s2">&#34;All required servicess are disabled for CIS Level 1.&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Exit</span> <span class="mf">0</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>


<p>Then a simple remediation script to loop through each service and disable it:</p>

<div class="flex mt-2">
<span
  class="rounded-full bg-primary-500 dark:bg-primary-400 text-neutral-50 dark:text-neutral-800 px-1.5 py-[1px] text-xs font-normal"
>
  <span class="flex flex-row items-center">
    
    <span class="mr-1">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>

  </span>

</span>
    
    <span><em>CIS (L1) System Services - Windows 11 Intune 3.0.1_Remediation.ps1</em></span>
  </span>
</span>
</div>







  
  

  
    
  
  
  

  
  
  
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl"><span class="nv">$cisServices</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;Browser&#39;</span><span class="p">,</span> <span class="c"># Computer Browser</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;IISADMIN&#39;</span><span class="p">,</span> <span class="c"># IIS Admin Service</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;irmon&#39;</span><span class="p">,</span> <span class="c"># Infrared monitor service</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;SharedAccess&#39;</span><span class="p">,</span> <span class="c"># Internet Connection Sharing</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;LxssManager&#39;</span><span class="p">,</span> <span class="c"># LxssManager</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;FTPSVC&#39;</span><span class="p">,</span> <span class="c"># Microsoft FTP Service</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;sshd&#39;</span><span class="p">,</span> <span class="c"># OpenSSH SSH Server</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;RpcLocator&#39;</span><span class="p">,</span> <span class="c"># Remote Procedure Call (RPC) Locator</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;RemoteAccess&#39;</span><span class="p">,</span> <span class="c"># Routing and Remote Access</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;simptcp&#39;</span><span class="p">,</span> <span class="c"># Simple TCP/IP LocalServices$LocalServices</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;sacsvr&#39;</span><span class="p">,</span> <span class="c"># Special Administration Console Helper</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;SSDPSRV&#39;</span><span class="p">,</span> <span class="c"># SSDP Discovery</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;upnphost&#39;</span><span class="p">,</span> <span class="c"># UPnP Device Host</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;WMSvc&#39;</span><span class="p">,</span> <span class="c"># Web Management Service</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;WMPNetworkSvc&#39;</span><span class="p">,</span> <span class="c"># Windows Media Player Network Sharing Service</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;icssvc&#39;</span><span class="p">,</span> <span class="c"># Windows Mobile Hotspot Service</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;W3SVC&#39;</span><span class="p">,</span> <span class="c"># World Wide Web Publishing Service</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;XboxGipSvc&#39;</span><span class="p">,</span> <span class="c"># Xbox Accessory Management Service</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;XblAuthManager&#39;</span><span class="p">,</span> <span class="c"># Xbox Live Auth Manager</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;XblGameSave&#39;</span><span class="p">,</span> <span class="c"># Xbox Live Game Save</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;XboxNetApiSvc&#39;</span> <span class="c"># Xbox Live Networking Service</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Get current state on the services in the array above.</span>
</span></span><span class="line"><span class="cl"><span class="nv">$localServices</span> <span class="p">=</span> <span class="nb">Get-Service</span> <span class="n">-Name</span> <span class="nv">$cisServices</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>
</span></span><span class="line"><span class="cl"><span class="nv">$notDisabled</span> <span class="p">=</span> <span class="mf">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$service</span> <span class="k">in</span> <span class="nv">$cisServices</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Make sure service name in the list matches with local system services.</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Added because of Computer Browser mismatch with &#34;bowser&#34; service</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$foundService</span> <span class="p">=</span> <span class="nv">$localServices</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="py">Name</span> <span class="o">-eq</span> <span class="nv">$service</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$foundService</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$foundService</span><span class="p">.</span><span class="py">StartType</span> <span class="o">-ne</span> <span class="s1">&#39;Disabled&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$notDisabled</span><span class="p">++</span>
</span></span><span class="line"><span class="cl">                <span class="nb">Set-Service</span> <span class="nv">$FoundService</span><span class="p">.</span><span class="py">Name</span> <span class="n">-StartupType</span> <span class="n">Disabled</span> <span class="n">-Force</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Output</span> <span class="s2">&#34;Found </span><span class="nv">$notDisabled</span><span class="s2"> service(s) that are now disabled.&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Exit</span> <span class="mf">0</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">catch</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Output</span> <span class="s2">&#34;Unable to disable </span><span class="nv">$notDisabled</span><span class="s2"> service(s).&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Exit</span> <span class="mf">2000</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>


<p>Deployed using Microsoft Intune to your devices:</p>
<p>



      <figure>
        <img
          class="my-0 rounded-md"
          loading="lazy"
          src="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/img/cis-l1remediation_hu13431213320165995152.png"
          alt="CIS Level 1 System Services Remediation"
        />
        <figcaption>CIS Level 1 services remediation in Microsoft Intune.</figcaption>
      </figure></p>
<p>Ensuring you set a suitable schedule for the remediation to run, daily is probably overkill, just make sure it&rsquo;s running before any kind of CIS audit 😂.</p>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  >

  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


  </span>

  <span
    
      class="dark:text-neutral-300"
    >The <a href="https://github.com/ennnbeee/mve-scripts/tree/main/Intune/Remediation/CIS/L1" target="_blank">CIS (L1) System Services - Windows 11 Intune 3.0.1</a> detection and remediation scripts are available for your to add into your Microsoft Intune tenant.</span>
</div>



<h2 class="relative group">Summary 
    <div id="summary" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#summary" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>What I&rsquo;ve learnt looking over the CIS Level 1 settings, is that there are some pretty large gaps in the build kit; settings that just don&rsquo;t exist such as with Windows LAPS, settings that only apply to users and not devices, settings that only apply to specific editions of Windows, minimum settings that will cause unexpected behaviour, and some normal good practice settings for security solutions such as Windows Defender that are just plain missing.</p>
<p>This does mean though, that applying a CIS benchmark is only <em>part</em> of the story when it comes to securing your Windows 11 cloud native devices, and it&rsquo;s worth looking into other <a href="https://learn.microsoft.com/en-us/mem/intune/protect/security-baselines" target="_blank">Security Baselines</a> (cough Microsoft cough) to help harden not only the operating system, but applications that reside on top.</p>
<p>Next up is the final part in the series, the dreaded CIS Level 2 settings, surely it can&rsquo;t get any worse?</p>

          
          
          
        </div>
        
        

        
<details style="margin-left:0px" class="mt-2 mb-5 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5">
    
    <summary
        class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-primary-800 dark:text-neutral-100">
        Patching Gaps in the CIS Windows 11 Benchmark - This article is part of a series.
    </summary>
    
    
    
    <div
        class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
        <a href="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part1/">
            Part 1: Patching Gaps in the CIS Windows 11 Benchmark - BitLocker
        </a>
    </div>
    
    
    
    <div
        class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
        <a href="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part2/">
            Part 2: Patching Gaps in the CIS Windows 11 Benchmark - Level 1 Windows Autopilot
        </a>
    </div>
    
    
    
    <div
        class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
        Part 3: This Article
    </div>
    
    
    
    <div
        class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
        <a href="https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part4/">
            Part 4: Patching Gaps in the CIS Windows 11 Benchmark - Level 2 Windows 11
        </a>
    </div>
    
    


</details>

        
  
  <section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/&amp;title=Patching%20Gaps%20in%20the%20CIS%20Windows%2011%20Benchmark%20-%20Level%201%20Windows%2011"
      title="Share on LinkedIn"
      aria-label="Share on LinkedIn"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://twitter.com/intent/tweet/?url=https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/&amp;text=Patching%20Gaps%20in%20the%20CIS%20Windows%2011%20Benchmark%20-%20Level%201%20Windows%2011"
      title="Tweet on Twitter"
      aria-label="Tweet on Twitter"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://reddit.com/submit/?url=https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/&amp;resubmit=true&amp;title=Patching%20Gaps%20in%20the%20CIS%20Windows%2011%20Benchmark%20-%20Level%201%20Windows%2011"
      title="Submit to Reddit"
      aria-label="Submit to Reddit"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://api.whatsapp.com/send?text=https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/&amp;resubmit=true&amp;title=Patching%20Gaps%20in%20the%20CIS%20Windows%2011%20Benchmark%20-%20Level%201%20Windows%2011"
      title="Share via WhatsApp"
      aria-label="Share via WhatsApp"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://t.me/share/url?url=https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/&amp;resubmit=true&amp;title=Patching%20Gaps%20in%20the%20CIS%20Windows%2011%20Benchmark%20-%20Level%201%20Windows%2011"
      title="Share via Telegram"
      aria-label="Share via Telegram"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M248,8C111.033,8,0,119.033,0,256S111.033,504,248,504,496,392.967,496,256,384.967,8,248,8ZM362.952,176.66c-3.732,39.215-19.881,134.378-28.1,178.3-3.476,18.584-10.322,24.816-16.948,25.425-14.4,1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25,5.342-39.5,3.652-3.793,67.107-61.51,68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608,69.142-14.845,10.194-26.894,9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7,18.45-13.7,108.446-47.248,144.628-62.3c68.872-28.647,83.183-33.623,92.511-33.789,2.052-.034,6.639.474,9.61,2.885a10.452,10.452,0,0,1,3.53,6.716A43.765,43.765,0,0,1,362.952,176.66Z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://pinterest.com/pin/create/bookmarklet/?url=https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/&amp;description=Patching%20Gaps%20in%20the%20CIS%20Windows%2011%20Benchmark%20-%20Level%201%20Windows%2011"
      title="Pin on Pinterest"
      aria-label="Pin on Pinterest"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M496 256c0 137-111 248-248 248-25.6 0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8 0 128.7-68.8 128.7-154.3 0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1 0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6 0-54.7 41.4-107.6 112-107.6 60.9 0 103.6 41.5 103.6 100.9 0 67.1-33.9 113.6-78 113.6-24.3 0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6 0-19-10.2-34.9-31.4-34.9-24.9 0-44.9 25.7-44.9 60.2 0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9 0 361.1 0 256 0 119 111 8 248 8s248 111 248 248z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://www.facebook.com/sharer/sharer.php?u=https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/&amp;quote=Patching%20Gaps%20in%20the%20CIS%20Windows%2011%20Benchmark%20-%20Level%201%20Windows%2011"
      title="Share on Facebook"
      aria-label="Share on Facebook"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="mailto:?body=https://memv.ennbee.uk/posts/windows-cis-patching-gaps-part3/&amp;subject=Patching%20Gaps%20in%20the%20CIS%20Windows%2011%20Benchmark%20-%20Level%201%20Windows%2011"
      title="Send via email"
      aria-label="Send via email"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>


    </a>
      
    
  </section>


        


<h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2>
<section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3">
  
  

  <a href="/posts/windows-cis-patching-gaps-part2/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/posts/windows-cis-patching-gaps-part2/featured.png);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/posts/windows-cis-patching-gaps-part2/">Patching Gaps in the CIS Windows 11 Benchmark - Level 1 Windows Autopilot</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  









  











<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-06-23T21:26:37&#43;01:00">23 June 2024</time><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="views_posts/Windows-CIS-Patching-Gaps-Part2/index.md" class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title="views">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
  </span>

</span>
</span>
  

  
  
</div>





<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/intune/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Microsoft Intune
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/windows/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Windows 10 and later
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/security/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Security
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/cis/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Center for Internet Security (CIS)
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/windows-autopilot/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Windows Autopilot
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/windows-hello/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Windows Hello
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/settings-catalog/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Settings Catalog
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/powershell/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    PowerShell
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>
  
  

  <a href="/posts/windows-cis-patching-gaps-part1/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/posts/windows-cis-patching-gaps-part1/featured.png);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/posts/windows-cis-patching-gaps-part1/">Patching Gaps in the CIS Windows 11 Benchmark - BitLocker</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  









  











<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-06-15T21:26:37&#43;01:00">15 June 2024</time><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="views_posts/Windows-CIS-Patching-Gaps-Part1/index.md" class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title="views">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
  </span>

</span>
</span>
  

  
  
</div>





<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/intune/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Microsoft Intune
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/windows/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Windows 10 and later
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/security/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Security
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/cis/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Center for Internet Security (CIS)
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/custom-profiles/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Custom Profiles
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/bitlocker/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    BitLocker
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/dma/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Direct Memory Access
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/settings-catalog/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Settings Catalog
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>
  
  

  <a href="/posts/resusable-firewall-settings-microsoft-online/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/posts/resusable-firewall-settings-microsoft-online/featured.jpg);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/posts/resusable-firewall-settings-microsoft-online/">Creating Reusable Groups of Firewall Settings for Microsoft Online Services</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  









  











<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-03-09T21:12:54&#43;00:00">9 March 2024</time><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="views_posts/Resusable-Firewall-Settings-Microsoft-Online/index.md" class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title="views">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
  </span>

</span>
</span>
  

  
  
</div>





<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/intune/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Microsoft Intune
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/windows/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Windows 10 and later
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/security/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Security
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/powershell/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    PowerShell
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/graph/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Graph API
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/settings-catalog/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Settings Catalog
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/firewall/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Firewall
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/automation/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Automation
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/endpoint-security/&#34;,'_self');">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Endpoint Security
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>
  
</section>

  
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\/Windows-CIS-Patching-Gaps-Part3\/index.md"
        var oid_likes = "likes_posts\/Windows-CIS-Patching-Gaps-Part3\/index.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
      
      
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/posts/firewall-rule-policy-conversion/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Microsoft Intune and the Curious Case of the Converting Firewall Rule Policy</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-07-22T21:14:28&#43;01:00">22 July 2024</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/posts/windows-autopilot-v2-renaming/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Renaming Windows Autopilot v2 Devices</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-07-02T21:25:20&#43;01:00">2 July 2024</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
    
    <div class="pt-3">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="pt-3">
        <script src="https://giscus.app/client.js"
    data-repo="ennnbeee/ennnbeee.github.io"
    data-repo-id="R_kgDOLUU7Lg"
    data-category="Comments"
    data-category-id="DIC_kwDOLUU7Ls4CdUYI"
    data-mapping="title"
    data-strict="0"
    data-reactions-enabled="0"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="https://memv.ennbee.uk/css/giscus.css"
    data-lang="en"
    data-loading=" lazy"
    crossorigin="anonymous"
    async>
  </script>
  <noscript>Please enable JavaScript to view the comments powered by giscus.</noscript>
      </div>
    </div>
    
    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
    <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
      <ul class="flex flex-col list-none sm:flex-row">
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/tags/"
            title="">
            
            Tags
          </a>
        </li>
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/categories/"
            title="">
            
            Categories
          </a>
        </li>
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/information/"
            title="">
            
            Information
          </a>
        </li>
        
      </ul>
    </nav>
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      © 2024 Nick Benton, MEM v ENNBEE
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="https://memv.ennbee.uk/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
